import{_ as s,c as a,o as n,a as l}from"./app.16764a97.js";const F=JSON.parse('{"title":"安装Docker到服务器","description":"","frontmatter":{},"headers":[],"relativePath":"backend/server/安装Docker到服务器.md"}'),p={name:"backend/server/安装Docker到服务器.md"},o=l(`<h1 id="安装docker到服务器" tabindex="-1">安装Docker到服务器 <a class="header-anchor" href="#安装docker到服务器" aria-hidden="true">#</a></h1><blockquote><p>前端开发人员基本上都会写前端项目和node后端服务，但如何将代码部署到服务器，相信不是每一位开发人员都会的，下面，针对不同的操作系统，分别讲解，如何部署项目到远端服务器</p></blockquote><p>目前接触的服务器类型大约有两种：</p><ul><li>Ubuntu 18.04 64位</li><li>CentOS 8.0 64位</li></ul><p>​ <strong>不同的服务器，部署方式有所不同。</strong></p><p>针对Ubuntu 18.04 64位阿里云服务器先安装Docker</p><ol><li><p>申请并连接远端服务器。</p></li><li><p>升级apt和添加相关软件包。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;"># apt升级</span></span>
<span class="line"><span style="color:#BABED8;">sudo apt</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">get update</span></span>
<span class="line"><span style="color:#BABED8;"># 添加相关软件包</span></span>
<span class="line"><span style="color:#BABED8;">sudo apt</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">get install \\</span></span>
<span class="line"><span style="color:#BABED8;">apt</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">transport</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">https \\</span></span>
<span class="line"><span style="color:#BABED8;">ca</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">certificates \\</span></span>
<span class="line"><span style="color:#BABED8;">curl \\</span></span>
<span class="line"><span style="color:#BABED8;">software</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">properties</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">common</span></span>
<span class="line"></span></code></pre></div></li><li><p>下载软件包的合法性，需要添加软件源的 GPG 密钥。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">curl </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">fsSL </span><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -</span></span>
<span class="line"></span></code></pre></div></li><li><p>source.list 中添加 Docker 软件源。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo add</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">apt</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">repository \\</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu </span><span style="color:#BABED8;">\\</span></span>
<span class="line"><span style="color:#C3E88D;">$(lsb_release -cs) </span><span style="color:#BABED8;">\\</span></span>
<span class="line"><span style="color:#C3E88D;">stable</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div></li><li><p>安装 Docker CE。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo apt</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">get update</span></span>
<span class="line"><span style="color:#BABED8;">sudo apt</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">get install docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span></span>
<span class="line"></span></code></pre></div></li><li><p>启动 Docker CE。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo systemctl enable docker</span></span>
<span class="line"><span style="color:#BABED8;">sudo systemctl start docker</span></span>
<span class="line"></span></code></pre></div></li><li><p>建立 docker 用户组(附加) 。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo groupadd docker</span></span>
<span class="line"><span style="color:#BABED8;">sudo usermod </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">aG docker $USER</span></span>
<span class="line"></span></code></pre></div></li><li><p>Helloworld 测试</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">docker run hello</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">world</span></span>
<span class="line"></span></code></pre></div></li><li><p>docker 拉取镜像时，可以设置镜像进行加速。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;"># </span><span style="color:#89DDFF;">/</span><span style="color:#BABED8;">etc</span><span style="color:#89DDFF;">/</span><span style="color:#BABED8;">docker</span><span style="color:#89DDFF;">/</span><span style="color:#BABED8;">daemon</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">json</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">registry-mirrors</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: [</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://dockerhub.azk8s.cn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://reg-mirror.qiniu.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 七牛云加速器</span></span>
<span class="line"><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">sudo systemctl daemon</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">reload</span></span>
<span class="line"><span style="color:#BABED8;">sudo systemctl restart docker</span></span>
<span class="line"></span></code></pre></div><p><strong>针对CentOS 8.0 64位腾讯云服务器 Docker安装</strong></p><p><strong>安装脚本自动安装</strong></p><p>安装命令如下：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#babed8;">curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>也可以使用国内 daocloud 一键安装命令：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#babed8;">curl -sSL https://get.daocloud.io/docker | sh</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p><strong>手动安装</strong></p><p>1.卸载旧版已安装docker如果有。</p><p>较旧的 Docker 版本称为 docker 或 docker-engine 。如果已安装这些程序，请卸载它们以及相关的依赖项。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo yum remove docker \\</span></span>
<span class="line"><span style="color:#BABED8;">                  docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">client \\</span></span>
<span class="line"><span style="color:#BABED8;">                  docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">client</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">latest \\</span></span>
<span class="line"><span style="color:#BABED8;">                  docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">common \\</span></span>
<span class="line"><span style="color:#BABED8;">                  docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">latest \\</span></span>
<span class="line"><span style="color:#BABED8;">                  docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">latest</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">logrotate \\</span></span>
<span class="line"><span style="color:#BABED8;">                  docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">logrotate \\</span></span>
<span class="line"><span style="color:#BABED8;">                  docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">engine</span></span>
<span class="line"></span></code></pre></div><p>2.安装 Docker Engine-Community</p><p>在新主机上首次安装 Docker Engine-Community 之前，需要设置 Docker 仓库。之后，您可以从仓库安装和更新 Docker。</p><p><strong>设置仓库</strong></p><p>安装所需的软件包。yum-utils 提供了 yum-config-manager ，并且 device mapper 存储驱动程序需要 device-mapper-persistent-data 和 lvm2。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo yum install </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">y yum</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">utils \\</span></span>
<span class="line"><span style="color:#BABED8;">  device</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">mapper</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">persistent</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">data \\</span></span>
<span class="line"><span style="color:#BABED8;">  lvm2</span></span>
<span class="line"></span></code></pre></div><p>使用以下命令来设置稳定的仓库。</p><h2 id="使用官方源地址-比较慢" tabindex="-1">使用官方源地址（比较慢） <a class="header-anchor" href="#使用官方源地址-比较慢" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo yum</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">config</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">manager \\</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">--</span><span style="color:#BABED8;">add</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">repo \\</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//download.docker.com/linux/centos/docker-ce.repo</span></span>
<span class="line"></span></code></pre></div><p>可以选择国内的一些源地址：</p><h2 id="阿里云" tabindex="-1">阿里云 <a class="header-anchor" href="#阿里云" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo yum</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">config</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">manager \\</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">--</span><span style="color:#BABED8;">add</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">repo \\</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span>
<span class="line"></span></code></pre></div><h2 id="清华大学源" tabindex="-1">清华大学源 <a class="header-anchor" href="#清华大学源" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">sudo yum</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">config</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">manager \\</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">--</span><span style="color:#BABED8;">add</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">repo \\</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo</span></span>
<span class="line"></span></code></pre></div><h2 id="安装-docker-engine-community" tabindex="-1">安装 Docker Engine-Community <a class="header-anchor" href="#安装-docker-engine-community" aria-hidden="true">#</a></h2><p>安装最新版本的 Docker Engine-Community 和 containerd，或者转到下一步安装特定版本：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#babed8;">sudo yum install docker-ce docker-ce-cli containerd.io</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>如果提示您接受 GPG 密钥，请选是。</p><blockquote><p><strong>有多个 Docker 仓库吗？</strong></p><p>如果启用了多个 Docker 仓库，则在未在 yum install 或 yum update 命令中指定版本的情况下，进行的安装或更新将始终安装最高版本，这可能不适合您的稳定性需求。</p></blockquote><p>Docker 安装完默认未启动。并且已经创建好 docker 用户组，但该用户组下没有用户。</p><p><strong>要安装特定版本的 Docker Engine-Community，请在存储库中列出可用版本，然后选择并安装：</strong></p><p>1、列出并排序您存储库中可用的版本。此示例按版本号（从高到低）对结果进行排序。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">yum list docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce </span><span style="color:#89DDFF;">--</span><span style="color:#BABED8;">showduplicates </span><span style="color:#89DDFF;">|</span><span style="color:#BABED8;"> sort </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">r</span></span>
<span class="line"><span style="color:#BABED8;">docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">x86_64  </span><span style="color:#F78C6C;">3</span><span style="color:#BABED8;">:</span><span style="color:#F78C6C;">18.09</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">3</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">el7                     docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">stable</span></span>
<span class="line"><span style="color:#BABED8;">docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">x86_64  </span><span style="color:#F78C6C;">3</span><span style="color:#BABED8;">:</span><span style="color:#F78C6C;">18.09</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">3</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">el7                     docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">stable</span></span>
<span class="line"><span style="color:#BABED8;">docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">x86_64  </span><span style="color:#F78C6C;">18.06</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">1</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">3</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">el7                    docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">stable</span></span>
<span class="line"><span style="color:#BABED8;">docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">x86_64  </span><span style="color:#F78C6C;">18.06</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">0</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">3</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">el7                    docker</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">ce</span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;">stable</span></span>
<span class="line"></span></code></pre></div><p>2、通过其完整的软件包名称安装特定版本，该软件包名称是软件包名称（docker-ce）加上版本字符串（第二列），从第一个冒号（:）一直到第一个连字符，并用连字符（-）分隔。例如：docker-ce-18.09.1。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#babed8;">sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>启动 Docker。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#babed8;">sudo systemctl start docker</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>通过运行 hello-world 映像来验证是否正确安装了 Docker Engine-Community 。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#babed8;">sudo docker run hello-world</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>docker 拉取镜像时，可以设置镜像进行加速。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">registry-mirrors</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://r9xxm8z8.mirror.aliyuncs.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://registry.docker-cn.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">insecure-registries</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">172.16.213.38:5000</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">172.16.213.39:5000</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>这样就可以同时使用公有和私有镜像仓库</p><p>重启docker</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">systemctl restart docker</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">service #重启Docker 即可</span></span>
<span class="line"></span></code></pre></div></li></ol>`,7),e=[o];function t(c,r,i,D,y,d){return n(),a("div",null,e)}const u=s(p,[["render",t]]);export{F as __pageData,u as default};

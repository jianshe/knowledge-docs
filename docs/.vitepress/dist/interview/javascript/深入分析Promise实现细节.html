<!DOCTYPE html>
<html lang="" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ·±å…¥åˆ†æPromiseå®ç°ç»†èŠ‚ | é‡ä½ å‰ç«¯è¿›é˜¶æŒ‡å—</title>
    <meta name="description" content="é‡ä½ å‰ç«¯è¿›é˜¶æŒ‡å—|Vue3|React|Vite|Cli|é¡¹ç›®å®æˆ˜">
    <link rel="preload stylesheet" href="/assets/style.e998413a.css" as="style">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.ade1a5ba.js">
    <link rel="modulepreload" href="/assets/chunks/VPAlgoliaSearchBox.51a8a4fa.js">
    <link rel="modulepreload" href="/assets/chunks/vue-plyr.esm.a9cb0b3f.js">
    <link rel="modulepreload" href="/assets/app.16764a97.js">
    <link rel="modulepreload" href="/assets/interview_javascript_æ·±å…¥åˆ†æPromiseå®ç°ç»†èŠ‚.md.4874a69d.lean.js">
    
    <link rel="alternate icon" href="https://cdn.jsdelivr.net/gh/jianshe/knowledgeAssets@v1.0.1/assets/albert.png" type="image/png" sizes="16x16">
  <link rel="stylesheet" href="https://unpkg.com/tailwindcss@2.0.4/dist/tailwind.min.css">
  <script src="https://hm.baidu.com/hm.js?ccf55dfd2764cf3ebf43d6b3c9da9b20"></script>
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-e99a7652 data-v-5e6dadf6><!--[--><!--]--><!--[--><span tabindex="-1" data-v-5c431eb1></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-5c431eb1> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5e6dadf6 data-v-cda327a5><div class="VPNavBar has-sidebar" data-v-cda327a5 data-v-26ec6288><div class="container" data-v-26ec6288><div class="title" data-v-26ec6288><div class="VPNavBarTitle has-sidebar" data-v-26ec6288 data-v-77f8b409><a class="title" href="/" data-v-77f8b409><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://cdn.jsdelivr.net/gh/jianshe/knowledgeAssets@v1.0.1/assets/albert.png" alt data-v-2ada2e1f><!--]--><!--[-->é‡ä½ å‰ç«¯è¿›é˜¶æŒ‡å—<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-26ec6288><div class="curtain" data-v-26ec6288></div><div class="content-body" data-v-26ec6288><!--[--><!--]--><div class="VPNavBarSearch search" data-v-26ec6288 style="--24e59988:&#39;Meta&#39;;"><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢æ–‡æ¡£</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-26ec6288 data-v-b26d96e9><span id="main-nav-aria-label" class="visually-hidden" data-v-b26d96e9>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview/" data-v-b26d96e9 data-v-27572fff data-v-efe1cb6f><!--[-->é¢è¯•è¯¾<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vue/" data-v-b26d96e9 data-v-27572fff data-v-efe1cb6f><!--[-->ğŸ”¥ç©è½¬Vue3<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/algorithm/" data-v-b26d96e9 data-v-27572fff data-v-efe1cb6f><!--[-->å‰ç«¯å­¦ç®—æ³•<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/source/" data-v-b26d96e9 data-v-27572fff data-v-efe1cb6f><!--[-->æºç æ¼«æ¸¸è®°<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/backend/" data-v-b26d96e9 data-v-27572fff data-v-efe1cb6f><!--[-->ç©è½¬åç«¯<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/japanese/" data-v-b26d96e9 data-v-27572fff data-v-efe1cb6f><!--[-->æ—¥è¯­<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-26ec6288 data-v-f7d738c0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-f7d738c0 data-v-6f58b759 data-v-1eadec0f><span class="check" data-v-1eadec0f><span class="icon" data-v-1eadec0f><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-6f58b759><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-6f58b759><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-26ec6288 data-v-439aa95e data-v-dd772e09><!--[--><a class="VPSocialLink" href="https://github.com/jianshe/knowledge-docs.git" target="_blank" rel="noopener" data-v-dd772e09 data-v-70d798b7><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-26ec6288 data-v-697b55b3 data-v-9fc40424><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9fc40424><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-9fc40424><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-9fc40424><div class="VPMenu" data-v-9fc40424 data-v-933b5022><!----><!--[--><!--[--><!----><div class="group" data-v-697b55b3><div class="item appearance" data-v-697b55b3><p class="label" data-v-697b55b3>Appearance</p><div class="appearance-action" data-v-697b55b3><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-697b55b3 data-v-6f58b759 data-v-1eadec0f><span class="check" data-v-1eadec0f><span class="icon" data-v-1eadec0f><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-6f58b759><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-6f58b759><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-697b55b3><div class="item social-links" data-v-697b55b3><div class="VPSocialLinks social-links-list" data-v-697b55b3 data-v-dd772e09><!--[--><a class="VPSocialLink" href="https://github.com/jianshe/knowledge-docs.git" target="_blank" rel="noopener" data-v-dd772e09 data-v-70d798b7><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-26ec6288 data-v-291b4a38><span class="container" data-v-291b4a38><span class="top" data-v-291b4a38></span><span class="middle" data-v-291b4a38></span><span class="bottom" data-v-291b4a38></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-5e6dadf6 data-v-f3fe1e38><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-f3fe1e38><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-f3fe1e38><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-f3fe1e38>Menu</span></button><a class="top-link" href="#" data-v-f3fe1e38>Return to top</a></div><aside class="VPSidebar" data-v-5e6dadf6 data-v-8630415e><div class="curtain" data-v-8630415e></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-8630415e><span class="visually-hidden" id="sidebar-aria-label" data-v-8630415e> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-8630415e><section class="VPSidebarItem level-0 collapsible has-active" data-v-8630415e data-v-f62c974e><div class="item" role="button" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link" data-v-f62c974e data-v-efe1cb6f><!--[--><h2 class="text" data-v-f62c974e>javascript</h2><!--]--><!----></a><div class="caret" role="button" data-v-f62c974e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-f62c974e><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-f62c974e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/Function.prototype.bind.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>Function.prototype.bind</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/JavaScript%E5%8F%AF%E8%A7%86%E5%8C%96%EF%BC%9APromise%E5%92%8CAsync.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>JavaScriptå¯è§†åŒ–ï¼šPromiseå’ŒAsync/Await</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/Promise%E9%87%8C%E7%9A%84%E4%BB%A3%E7%A0%81%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AF%94setTimeout%E5%85%88%E6%89%A7%E8%A1%8C%EF%BC%9F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>Promiseé‡Œçš„ä»£ç ä¸ºä»€ä¹ˆæ¯”setTimeoutå…ˆæ‰§è¡Œï¼Ÿ</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/call%20%E5%92%8Capply.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>call å’Œ apply</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/in%C2%A0%E8%BF%90%E7%AE%97%E7%AC%A6%E5%92%8C%C2%A0Object.hasOwnProperty%C2%A0%E6%96%B9%E6%B3%95%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>inÂ è¿ç®—ç¬¦å’ŒÂ Object.hasOwnPropertyÂ æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/javascript%E4%B8%ADProxy%E5%92%8CdefineProperty%E5%AF%B9%E6%AF%94.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>javascriptä¸­Proxyå’ŒdefinePropertyå¯¹æ¯”</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/javascript%E7%9A%84new%E6%93%8D%E4%BD%9C%E9%83%BD%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>javascriptçš„newæ“ä½œéƒ½åšäº†ä»€ä¹ˆï¼Ÿ </p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B--%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>javascriptè®¾è®¡æ¨¡å¼ä¹‹--å•ä¾‹æ¨¡å¼</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B--%E6%9E%84%E5%BB%BA%E5%87%BD%E6%95%B0%E6%A8%A1%E5%BC%8F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>javascriptè®¾è®¡æ¨¡å¼ä¹‹--æ„å»ºå‡½æ•°æ¨¡å¼</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>javascriptè®¾è®¡æ¨¡å¼ä¹‹å¤–è§‚æ¨¡å¼</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e> javascriptè®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>javascriptè®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼ </p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>javascriptè®¾è®¡æ¨¡å¼ä¹‹è£…é¥°è€…æ¨¡å¼</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E4%BB%B6%E4%BC%A0%E6%92%AD%EF%BC%9F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>ä»€ä¹ˆæ˜¯äº‹ä»¶ä¼ æ’­ï¼Ÿ</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E5%8E%9F%E7%94%9FJS%E7%81%B5%E9%AD%82%E4%B9%8B%E9%97%AE%EF%BC%8C%E8%AF%B7%E9%97%AE%E4%BD%A0%E8%83%BD%E6%8E%A5%E5%BE%97%E4%BD%8F%E5%87%A0%E4%B8%AA(%E4%B8%8A).html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>åŸç”ŸJSçµé­‚ä¹‹é—®ï¼Œè¯·é—®ä½ èƒ½æ¥å¾—ä½å‡ ä¸ª(ä¸Š)</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E5%A6%82%E4%BD%95%E5%86%99%E5%87%BA%E4%B8%80%E4%B8%AA%E6%83%8A%E8%89%B3%E9%9D%A2%E8%AF%95%E5%AE%98%E7%9A%84%E6%B7%B1%E6%8B%B7%E8%B4%9D%EF%BC%9F.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>å¦‚ä½•å†™å‡ºä¸€ä¸ªæƒŠè‰³é¢è¯•å®˜çš„æ·±æ‹·è´ï¼Ÿ </p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90Promise%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥åˆ†æPromiseå®ç°ç»†èŠ‚</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94[%E4%BD%9C%E7%94%A8%E5%9F%9F]%E5%92%8C[%E4%B8%8A%E4%B8%8B%E6%96%87%E7%8E%AF%E5%A2%83].html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”[ä½œç”¨åŸŸ]å’Œ[ä¸Šä¸‹æ–‡ç¯å¢ƒ]</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94instanceof.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”instanceof</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94prototype%E5%8E%9F%E5%9E%8B.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”prototypeåŸå‹</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94this.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”this</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E3%80%90%E9%97%AD%E5%8C%85%E4%B8%80%E3%80%91.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ã€é—­åŒ…ä¸€ã€‘</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E3%80%90%E9%97%AD%E5%8C%85%E4%BA%8C%E3%80%91.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ã€é—­åŒ…äºŒã€‘ </p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E5%AF%B9%E8%B1%A1.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E4%BB%8E[%E8%87%AA%E7%94%B1%E5%8F%98%E9%87%8F]%E5%88%B0[%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE].html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ä»[è‡ªç”±å˜é‡]åˆ°[ä½œç”¨åŸŸé“¾]</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E5%87%BD%E6%95%B0%E5%92%8C%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%B3%E7%B3%BB.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£ javascript åŸå‹å’Œé—­åŒ…â€”å‡½æ•°å’Œå¯¹è±¡çš„å…³ç³»</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E6%A0%88.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E7%AE%80%E4%BB%8B[%E4%BD%9C%E7%94%A8%E5%9F%9F].html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ç®€ä»‹[ä½œç”¨åŸŸ]</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E7%AE%80%E8%BF%B0%E3%80%90%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E3%80%91%E4%B8%8A.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ç®€è¿°ã€æ‰§è¡Œä¸Šä¸‹æ–‡ã€‘ä¸Š.md</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E7%AE%80%E8%BF%B0%E3%80%90%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E3%80%91%E4%B8%8B.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ç®€è¿°ã€æ‰§è¡Œä¸Šä¸‹æ–‡ã€‘ä¸‹.md</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E7%BB%A7%E6%89%BF.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ç»§æ‰¿</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94%E9%9A%90%E5%BC%8F%E5%8E%9F%E5%9E%8B.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”éšå¼åŸå‹</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E2%80%94%E8%8A%82%E6%B5%81.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>é˜²æŠ–å’ŒèŠ‚æµåŸç†åˆ†æâ€”èŠ‚æµ</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/javascript/%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E2%80%94%E9%98%B2%E6%8A%96.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>é˜²æŠ–å’ŒèŠ‚æµåŸç†åˆ†æâ€”é˜²æŠ–</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-8630415e><section class="VPSidebarItem level-0 collapsible collapsed" data-v-8630415e data-v-f62c974e><div class="item" role="button" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link" data-v-f62c974e data-v-efe1cb6f><!--[--><h2 class="text" data-v-f62c974e>css3</h2><!--]--><!----></a><div class="caret" role="button" data-v-f62c974e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-f62c974e><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-f62c974e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/css3/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0%E7%9A%84%E6%B0%B4%E5%B9%B3%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>å¦‚ä½•å®ç°ä¸€ä¸ªå…ƒç´ çš„æ°´å¹³å‚ç›´å±…ä¸­</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-8630415e><section class="VPSidebarItem level-0 collapsible collapsed" data-v-8630415e data-v-f62c974e><div class="item" role="button" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link" data-v-f62c974e data-v-efe1cb6f><!--[--><h2 class="text" data-v-f62c974e>vue</h2><!--]--><!----></a><div class="caret" role="button" data-v-f62c974e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-f62c974e><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-f62c974e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/vue/%E6%89%8B%E5%86%99Vue%E6%BA%90%E7%A0%81.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>æ‰‹å†™ Vue æºç </p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-8630415e><div class="VPSidebarItem level-0 collapsible collapsed" data-v-8630415e data-v-f62c974e><div class="item" role="button" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>vue-router</p><!--]--><!----></a><div class="caret" role="button" data-v-f62c974e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-f62c974e><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><!----></div></div><div class="group" data-v-8630415e><section class="VPSidebarItem level-0 collapsible collapsed" data-v-8630415e data-v-f62c974e><div class="item" role="button" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link" data-v-f62c974e data-v-efe1cb6f><!--[--><h2 class="text" data-v-f62c974e>element</h2><!--]--><!----></a><div class="caret" role="button" data-v-f62c974e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-f62c974e><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-f62c974e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f62c974e data-v-f62c974e><div class="item" data-v-f62c974e><div class="indicator" data-v-f62c974e></div><a class="VPLink link link" href="/interview/element/Element-ui%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8Bbutton%E7%BB%84%E4%BB%B6.html" data-v-f62c974e data-v-efe1cb6f><!--[--><p class="text" data-v-f62c974e>Element-uiæºç è§£æä¹‹buttonç»„ä»¶</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5e6dadf6 data-v-78de6848><div class="VPDoc has-sidebar has-aside" data-v-78de6848 data-v-a18e9499><div class="container" data-v-a18e9499><div class="aside" data-v-a18e9499><div class="aside-curtain" data-v-a18e9499></div><div class="aside-container" data-v-a18e9499><div class="aside-content" data-v-a18e9499><div class="VPDocAside" data-v-a18e9499 data-v-5bd648bd><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-5bd648bd data-v-58c49e3d><div class="content" data-v-58c49e3d><div class="outline-marker" data-v-58c49e3d></div><div class="outline-title" data-v-58c49e3d>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-58c49e3d><span class="visually-hidden" id="doc-outline-aria-label" data-v-58c49e3d> Table of Contents for current page </span><ul class="root" data-v-58c49e3d data-v-99ba19c4><!--[--><li data-v-99ba19c4><a class="outline-link" href="#ä¸€ã€promiseæ ¸å¿ƒé€»è¾‘å®ç°" data-v-99ba19c4>ä¸€ã€Promiseæ ¸å¿ƒé€»è¾‘å®ç°</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#äºŒã€åœ¨-promise-ç±»ä¸­åŠ å…¥å¼‚æ­¥é€»è¾‘" data-v-99ba19c4>äºŒã€åœ¨ Promise ç±»ä¸­åŠ å…¥å¼‚æ­¥é€»è¾‘</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_1-ç¼“å­˜æˆåŠŸä¸å¤±è´¥å›è°ƒ" data-v-99ba19c4>1. ç¼“å­˜æˆåŠŸä¸å¤±è´¥å›è°ƒ</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_2-then-æ–¹æ³•ä¸­çš„-pending-çš„å¤„ç†" data-v-99ba19c4>2. then æ–¹æ³•ä¸­çš„ Pending çš„å¤„ç†</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_3-resolve-ä¸-reject-ä¸­è°ƒç”¨å›è°ƒå‡½æ•°" data-v-99ba19c4>3. resolve ä¸ reject ä¸­è°ƒç”¨å›è°ƒå‡½æ•°</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#ä¸‰ã€å®ç°thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨æ·»åŠ å¤šä¸ªå¤„ç†å‡½æ•°" data-v-99ba19c4>ä¸‰ã€å®ç°thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨æ·»åŠ å¤šä¸ªå¤„ç†å‡½æ•°</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_1-mypromiseç±»ä¸­æ–°å¢ä¸¤ä¸ªæ•°ç»„" data-v-99ba19c4>1.MyPromiseç±»ä¸­æ–°å¢ä¸¤ä¸ªæ•°ç»„</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_2-å›è°ƒå‡½æ•°å­˜å…¥æ•°ç»„ä¸­" data-v-99ba19c4>2.å›è°ƒå‡½æ•°å­˜å…¥æ•°ç»„ä¸­</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_3-å¾ªç¯è°ƒç”¨æˆåŠŸå’Œå¤±è´¥å›è°ƒ" data-v-99ba19c4>3. å¾ªç¯è°ƒç”¨æˆåŠŸå’Œå¤±è´¥å›è°ƒ</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#å››ã€å®ç°thenæ–¹æ³•çš„é“¾å¼è°ƒç”¨" data-v-99ba19c4>å››ã€å®ç°thenæ–¹æ³•çš„é“¾å¼è°ƒç”¨</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#äº”ã€thenæ–¹æ³•é“¾å¼è°ƒç”¨è¯†åˆ«promiseæ˜¯å¦è¿”å›è‡ªå·±" data-v-99ba19c4>äº”ã€thenæ–¹æ³•é“¾å¼è°ƒç”¨è¯†åˆ«Promiseæ˜¯å¦è¿”å›è‡ªå·±</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#å…­ã€æ•è·é”™è¯¯åŠthené“¾å¼è°ƒç”¨å…¶ä»–çŠ¶æ€ä»£ç è¡¥å……" data-v-99ba19c4>å…­ã€æ•è·é”™è¯¯åŠthené“¾å¼è°ƒç”¨å…¶ä»–çŠ¶æ€ä»£ç è¡¥å……</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#ä¸ƒã€å‚è€ƒfulfilledçŠ¶æ€ä¸‹çš„å¤„ç†æ–¹å¼-å¯¹rejectedå’ŒpendingçŠ¶æ€è¿›è¡Œæ”¹é€ " data-v-99ba19c4>ä¸ƒã€å‚è€ƒfulfilledçŠ¶æ€ä¸‹çš„å¤„ç†æ–¹å¼ï¼Œå¯¹rejectedå’ŒpendingçŠ¶æ€è¿›è¡Œæ”¹é€ </a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#å…«ã€thenä¸­çš„å‚æ•°å˜ä¸ºå¯é€‰" data-v-99ba19c4>å…«ã€thenä¸­çš„å‚æ•°å˜ä¸ºå¯é€‰</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#ä¹ã€å®ç°resolveä¸rejectçš„é™æ€è°ƒç”¨" data-v-99ba19c4>ä¹ã€å®ç°resolveä¸rejectçš„é™æ€è°ƒç”¨</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#promise-a-æµ‹è¯•" data-v-99ba19c4>Promise A+ æµ‹è¯•</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_1-å®‰è£…ä¸€ä¸‹" data-v-99ba19c4>1. å®‰è£…ä¸€ä¸‹</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_2-æ‰‹å†™ä»£ç ä¸­åŠ å…¥-deferred" data-v-99ba19c4>2. æ‰‹å†™ä»£ç ä¸­åŠ å…¥ deferred</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#_3-é…ç½®å¯åŠ¨å‘½ä»¤" data-v-99ba19c4>3. é…ç½®å¯åŠ¨å‘½ä»¤</a><!----></li><li data-v-99ba19c4><a class="outline-link" href="#æœ€ç»ˆæ—¶åˆ»-å¦‚ä½•è§£é‡Šé‚£é“é¢è¯•é¢˜çš„æ‰§è¡Œç»“æœ" data-v-99ba19c4>æœ€ç»ˆæ—¶åˆ»ï¼Œå¦‚ä½•è§£é‡Šé‚£é“é¢è¯•é¢˜çš„æ‰§è¡Œç»“æœ</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-5bd648bd></div><!--[--><!--]--><!----><!--[--><!--[--><!--[--><!--[--><canvas id="live2d" width="300" height="550" data-v-e99a7652></canvas><!--]--><!--]--><!--]--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-a18e9499><div class="content-container" data-v-a18e9499><!--[--><!--]--><main class="main" data-v-a18e9499><div style="position:relative;" class="vp-doc _interview_javascript_%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90Promise%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82" data-v-a18e9499><div><h1 id="æ·±å…¥åˆ†æpromiseå®ç°ç»†èŠ‚" tabindex="-1">æ·±å…¥åˆ†æPromiseå®ç°ç»†èŠ‚ <a class="header-anchor" href="#æ·±å…¥åˆ†æpromiseå®ç°ç»†èŠ‚" aria-hidden="true">#</a></h1><p>å¦‚æœæ„Ÿè§‰å¯¹Promiseè¿˜ä¸å¤ªç†Ÿæ‚‰çš„å°±å…ˆç§»æ­¥<a href="https://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noreferrer">Promiseå…¥é—¨</a>ï¼Œç¨å¾®åšä¸€ä¸‹çŸ¥è¯†é¢„ä¹ ï¼Œäº†è§£ä¸€ä¸‹Promiseçš„å¸¸è§„ç”¨æ³• ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ï¼Ÿ</strong></p><p>â€‹ æˆ‘ä»¬éƒ½çŸ¥é“jsæ˜¯å•çº¿ç¨‹ï¼Œä½†æ˜¯ä¸€äº›é«˜è€—æ—¶æ“ä½œå°±å¸¦æ¥äº†è¿›ç¨‹é˜»å¡é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJsæœ‰ä¸¤ç§ä»»åŠ¡çš„æ‰§è¡Œæ¨¡å¼ï¼šã€åŒæ­¥æ¨¡å¼(Synchronous)å’Œå¼‚æ­¥æ¨¡å¼(Asynchronous)ã€‘ã€‚</p><p>â€‹ åœ¨å¼‚æ­¥æ¨¡å¼ä¸‹ï¼Œåˆ›å»ºã€å¼‚æ­¥ä»»åŠ¡ä¸»è¦åˆ†ä¸ºå®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ä¸¤ç§ã€‘ã€‚Es6è§„èŒƒä¸­ï¼Œå®ä»»åŠ¡(Macrotask)ç§°ä¸ºTaskï¼Œå¾®ä»»åŠ¡(Microtask)ç§°ä¸ºJobsã€‚å®ä»»åŠ¡æ˜¯ç”±å®¿ä¸»ï¼ˆæµè§ˆå™¨ã€Nodeï¼‰å‘èµ·çš„ï¼Œè€Œå¾®ä»»åŠ¡ç”±JSè‡ªèº«å‘èµ·çš„ã€‚</p><p>â€‹ <strong>å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡çš„å‡ ç§åˆ›å»ºæ–¹å¼</strong></p><table><thead><tr><th>å®ä»»åŠ¡ï¼ˆMacrotaskï¼‰</th><th>å¾®ä»»åŠ¡(Microtask)</th></tr></thead><tbody><tr><td>setTimeout</td><td>requestAnimationFrame</td></tr><tr><td>setInterval</td><td>MutationObserver(æµè§ˆå™¨ç¯å¢ƒ)</td></tr><tr><td>MessageChannel</td><td>Promise.[then/catch/finally]</td></tr><tr><td>I/Oï¼Œäº‹ä»¶é˜Ÿåˆ—</td><td>process.nextTick(Nodeç¯å¢ƒ)</td></tr><tr><td>setImmediate(Nodeç¯å¢ƒ)</td><td>queueMicrotask</td></tr><tr><td>script(æ•´ä½“ä»£ç å—)</td><td></td></tr></tbody></table><p><strong>æ‰‹å†™å¼€å§‹</strong></p><p>å¾ˆå¤šæ‰‹å†™ç‰ˆæœ¬éƒ½æ˜¯ä½¿ç”¨setTimeoutå»åšå¼‚æ­¥å¤„ç†ï¼Œä½†æ˜¯setTimeoutå±äºå®ä»»åŠ¡ï¼Œè¿™ä¸Promiseæ˜¯ä¸ªå¾®ä»»åŠ¡ç›¸çŸ›ç›¾ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—é€‰æ‹©ä¸€ç§åˆ›å»ºå¾®ä»»åŠ¡çš„æ–¹å¼å»å®ç°æˆ‘ä»¬çš„æ‰‹å†™ä»£ç ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬æœ‰å‡ ç§é€‰æ‹©ï¼Œä¸€ç§å°±æ˜¯Promise A+è§„èŒƒä¸­ä¹Ÿæåˆ°çš„ï¼Œprocess.nextTick(Nodeç«¯)ä¸MutationObserver(æµè§ˆå™¨ç«¯)ï¼Œè€ƒè™‘åˆ°åˆ©ç”¨è¿™ä¸¤ç§æ–¹å¼éœ€è¦åšç¯å¢ƒåˆ¤æ–­ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬å°±æ¨èå¦å¤–ä¸€ç§åˆ›å»ºå¾®ä»»åŠ¡çš„æ–¹å¼queueMicrotaskï¼Œäº†è§£æ›´å¤š--&gt;<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_DOM_API/Microtask_guide" target="_blank" rel="noreferrer">åœ¨ JavaScript ä¸­é€šè¿‡ queueMicrotask() ä½¿ç”¨å¾®ä»»åŠ¡</a>;</p><h2 id="ä¸€ã€promiseæ ¸å¿ƒé€»è¾‘å®ç°" tabindex="-1">ä¸€ã€Promiseæ ¸å¿ƒé€»è¾‘å®ç° <a class="header-anchor" href="#ä¸€ã€promiseæ ¸å¿ƒé€»è¾‘å®ç°" aria-hidden="true">#</a></h2><p>æˆ‘ä»¬å…ˆç®€å•å®ç°ä¸€ä¸‹Promiseçš„åŸºç¡€åŠŸèƒ½ã€‚å…ˆçœ‹åŸç”ŸPromiseå®ç°çš„ï¼Œç¬¬ä¸€æ­¥æˆ‘ä»¬è¦å®Œæˆç›¸åŒçš„åŠŸèƒ½ã€‚</p><p><strong>åŸç”Ÿï¼š</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">err</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(value </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    console.log(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> value)</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">reject</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// è¾“å‡º resolve success</span></span>
<span class="line"></span></code></pre></div><blockquote><p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€åŸºæœ¬åŸç†ã€‘ï¼š</p><ol><li>Promiseæ˜¯ä¸€ä¸ªç±»ï¼Œåœ¨æ‰§è¡Œè¿™ä¸ªç±»çš„æ—¶å€™ä¼šä¼ å…¥ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œè¿™ä¸ªæ‰§è¡Œå™¨ä¼šç«‹å³æ‰§è¡Œã€‚</li><li>Promiseæœ‰ä¸‰ç§çŠ¶æ€ <ul><li>Pendingç­‰å¾…</li><li>Fulfilledå®Œæˆ</li><li>Rejectedå¤±è´¥</li></ul></li><li>çŠ¶æ€åªèƒ½ç”±Pending--&gt;Fulfilledæˆ–è€…Pending --&gt;Rejected,ä¸”ä¸€ä½†å‘ç”Ÿæ”¹å˜ä¾¿ä¸å¯äºŒæ¬¡ä¿®æ”¹ã€‚</li><li>Promiseä¸­ä½¿ç”¨resolveå’Œrejectä¸¤ä¸ªå‡½æ•°æ¥æ›´æ”¹çŠ¶æ€ï¼›</li><li>thenæ–¹æ³•å†…éƒ¨åšçš„äº‹æƒ…å°±æ˜¯çŠ¶æ€åˆ¤æ–­ <ul><li>å¦‚æœçŠ¶æ€æ˜¯æˆåŠŸï¼Œè°ƒç”¨æˆåŠŸå›è°ƒå‡½æ•°</li><li>å¦‚æœçŠ¶æ€æ˜¯å¤±è´¥ï¼Œè°ƒç”¨å¤±è´¥å›è°ƒå‡½æ•°</li></ul></li></ol></blockquote><p><strong>ä¸‹é¢æˆ‘ä»¬å¼€å§‹å®ç°</strong></p><p>1.æ–°å»ºMyPromiseç±»ï¼Œä¼ å…¥æ‰§è¡Œå™¨executor</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// æ–°å»ºMyPromiseç±»</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">executor</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// executoræ˜¯ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œè¿›å…¥ä¼šç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">executor</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>2.executorä¼ å…¥resolveå’Œrejectæ–¹æ³•</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ–°å»ºMyPromiseç±»</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">executor</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// executoræ˜¯ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œè¿›å…¥ä¼šç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// å¹¶ä¼ å…¥resolveå’Œrejectæ–¹æ³•</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">executor</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,this.</span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// resolveå’Œrejectä¸ºä»€ä¹ˆè¦ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¦‚æœç›´æ¥è°ƒç”¨çš„è¯ï¼Œæ™®é€šå‡½æ•°thisæŒ‡å‘çš„æ˜¯windowæˆ–è€…undefined</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç”¨ç®­å¤´å‡½æ•°å°±å¯ä»¥è®©thisæŒ‡å‘å½“å‰å®ä¾‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//æ›´æ”¹æˆåŠŸåçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">resolve</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">reject</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>3.çŠ¶æ€ä¸ç»“æœçš„ç®¡ç†</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å…ˆå®šä¹‰ä¸‰ä¸ªå¸¸é‡è¡¨ç¤ºçŠ¶æ€</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> PENDING </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pending</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> FUFILLED </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fulfilled</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> REJECTED </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rejected</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ–°å»ºMyPromiseç±»</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">executor</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// executoræ˜¯ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œè¿›å…¥ä¼šç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// å¹¶ä¼ å…¥resolveå’Œrejectæ–¹æ³•</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">executor</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,this.</span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å‚¨å­˜çŠ¶æ€çš„å˜é‡ï¼Œåˆå§‹å€¼æ˜¯pending</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">status</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> PENDING</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// resolveå’Œrejectä¸ºä»€ä¹ˆè¦ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¦‚æœç›´æ¥è°ƒç”¨çš„è¯ï¼Œæ™®é€šå‡½æ•°thisæŒ‡å‘çš„æ˜¯windowæˆ–è€…undefined</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç”¨ç®­å¤´å‡½æ•°å°±å¯ä»¥è®©thisæŒ‡å‘å½“å‰å®ä¾‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#89DDFF;">	</span><span style="color:#676E95;font-style:italic;">// æˆåŠŸä¹‹åçš„å€¼</span></span>
<span class="line"><span style="color:#BABED8;">	</span><span style="color:#F07178;">value</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#89DDFF;">	</span><span style="color:#676E95;font-style:italic;">// å¤±è´¥ä¹‹åçš„åŸå› </span></span>
<span class="line"><span style="color:#BABED8;">	</span><span style="color:#F07178;">reason</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//æ›´æ”¹æˆåŠŸåçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">resolve</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">		</span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€ä¿®æ”¹ä¸ºæˆåŠŸ</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FUFILLED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜æˆåŠŸä¹‹åçš„å€¼</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æ›´æ”¹å¤±è´¥åçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">reject</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€ä¿®æ”¹ä¸ºå¤±è´¥</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜æˆå¤±è´¥åçš„åŸå› </span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>4.thençš„ç®€å•å®ç°</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(onFullfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> onRejected) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­çŠ¶æ€</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FUFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨æˆåŠŸå›è°ƒï¼Œå¹¶ä¸”æŠŠå€¼è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">onFullfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>5.ä½¿ç”¨module.exportså¯¹å¤–æš´éœ²MyPromiseç±»</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> MyPromise</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>çœ‹ä¸€ä¸‹æˆ‘ä»¬ç›®å‰å®ç°çš„**[å®Œæ•´ä»£ç ]**</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å…ˆå®šä¹‰ä¸‰ä¸ªå¸¸é‡è¡¨ç¤ºçŠ¶æ€</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> PENDING </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pending</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> FULFILLED </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fulfilled</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> REJECTED </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rejected</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ–°å»º MyPromise ç±»</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">executor</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// executor æ˜¯ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œè¿›å…¥ä¼šç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¹¶ä¼ å…¥resolveå’Œrejectæ–¹æ³•</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">executor</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å‚¨å­˜çŠ¶æ€çš„å˜é‡ï¼Œåˆå§‹å€¼æ˜¯ pending</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">status</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> PENDING</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// resolveå’Œrejectä¸ºä»€ä¹ˆè¦ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœç›´æ¥è°ƒç”¨çš„è¯ï¼Œæ™®é€šå‡½æ•°thisæŒ‡å‘çš„æ˜¯windowæˆ–è€…undefined</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ç”¨ç®­å¤´å‡½æ•°å°±å¯ä»¥è®©thisæŒ‡å‘å½“å‰å®ä¾‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æˆåŠŸä¹‹åçš„å€¼</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">value</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¤±è´¥ä¹‹åçš„åŸå› </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">reason</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æ›´æ”¹æˆåŠŸåçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">resolve</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€ä¿®æ”¹ä¸ºæˆåŠŸ</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜æˆåŠŸä¹‹åçš„å€¼</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æ›´æ”¹å¤±è´¥åçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">reject</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€æˆåŠŸä¸ºå¤±è´¥</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜å¤±è´¥åçš„åŸå› </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">then</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">onRejected</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­çŠ¶æ€</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨æˆåŠŸå›è°ƒï¼Œå¹¶ä¸”æŠŠå€¼è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> MyPromise</span></span>
<span class="line"></span></code></pre></div><p>ä½¿ç”¨æˆ‘çš„æ‰‹å†™ä»£ç æ‰§è¡Œä¸€ä¸‹ä¸Šé¢é‚£ä¸ª</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// æ–°å»º test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å¼•å…¥æˆ‘ä»¬çš„ MyPromise.js</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">err</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">reject</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ‰§è¡Œç»“æœï¼šresolve success</span></span>
<span class="line"></span></code></pre></div><p>æ‰§è¡Œç»“æœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œç¬¬ä¸€æ­¥å®Œæˆäº† ã€‚</p><h2 id="äºŒã€åœ¨-promise-ç±»ä¸­åŠ å…¥å¼‚æ­¥é€»è¾‘" tabindex="-1"><strong>äºŒã€åœ¨ Promise ç±»ä¸­åŠ å…¥å¼‚æ­¥é€»è¾‘</strong> <a class="header-anchor" href="#äºŒã€åœ¨-promise-ç±»ä¸­åŠ å…¥å¼‚æ­¥é€»è¾‘" aria-hidden="true">#</a></h2><p>â€‹ ä¸Šé¢è¿˜æ²¡æœ‰ç»è¿‡å¼‚æ­¥å¤„ç†ï¼Œå¦‚æœæœ‰å¼‚æ­¥é€»è¾‘åŠ å…¥ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">setTimeout</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2000</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">reject</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ²¡æœ‰æ‰“å°ä¿¡æ¯ï¼ï¼ï¼</span></span>
<span class="line"></span></code></pre></div><p><strong>åˆ†æåŸå› </strong></p><blockquote><p>â€œä¸»çº¿ç¨‹ä»£ç ç«‹å³æ‰§è¡Œï¼ŒsetTimeoutæ˜¯å¼‚æ­¥ä»£ç ï¼Œthenä¼šé©¬ä¸Šæ‰§è¡Œï¼Œè¿™ä¸ªæ—¶å€™åˆ¤æ–­PromiseçŠ¶æ€ï¼ŒçŠ¶æ€æ˜¯Pendingï¼Œç„¶è€Œä¹‹å‰å¹¶æ²¡æœ‰åˆ¤æ–­ç­‰å¾…è¿™ä¸ªçŠ¶æ€â€</p></blockquote><p>è¿™é‡Œå°±éœ€è¦æˆ‘ä»¬å¤„ç†ä¸€ä¸‹PendingçŠ¶æ€ï¼Œæˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ä¹‹å‰çš„ä»£ç </p><h2 id="_1-ç¼“å­˜æˆåŠŸä¸å¤±è´¥å›è°ƒ" tabindex="-1">1. ç¼“å­˜æˆåŠŸä¸å¤±è´¥å›è°ƒ <a class="header-anchor" href="#_1-ç¼“å­˜æˆåŠŸä¸å¤±è´¥å›è°ƒ" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise ç±»ä¸­æ–°å¢</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å­˜å‚¨æˆåŠŸå›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:#BABED8;">onFulfilledCallback </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å­˜å‚¨å¤±è´¥å›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:#BABED8;">onRejectedCallback </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"></span></code></pre></div><h2 id="_2-then-æ–¹æ³•ä¸­çš„-pending-çš„å¤„ç†" tabindex="-1">2. then æ–¹æ³•ä¸­çš„ Pending çš„å¤„ç† <a class="header-anchor" href="#_2-then-æ–¹æ³•ä¸­çš„-pending-çš„å¤„ç†" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> onRejected) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­çŠ¶æ€</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨æˆåŠŸå›è°ƒï¼Œå¹¶ä¸”æŠŠå€¼è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å› ä¸ºä¸çŸ¥é“åé¢çŠ¶æ€çš„å˜åŒ–æƒ…å†µï¼Œæ‰€ä»¥å°†æˆåŠŸå›è°ƒå’Œå¤±è´¥å›è°ƒå­˜å‚¨èµ·æ¥</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç­‰åˆ°æ‰§è¡ŒæˆåŠŸå¤±è´¥å‡½æ•°çš„æ—¶å€™å†ä¼ é€’</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallback</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onFulfilled</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallback</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onRejected</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="_3-resolve-ä¸-reject-ä¸­è°ƒç”¨å›è°ƒå‡½æ•°" tabindex="-1">3. resolve ä¸ reject ä¸­è°ƒç”¨å›è°ƒå‡½æ•° <a class="header-anchor" href="#_3-resolve-ä¸-reject-ä¸­è°ƒç”¨å›è°ƒå‡½æ•°" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ›´æ”¹æˆåŠŸåçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#82AAFF;">resolve</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€ä¿®æ”¹ä¸ºæˆåŠŸ</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜æˆåŠŸä¹‹åçš„å€¼</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­æˆåŠŸå›è°ƒæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±è°ƒç”¨</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallback</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">onFulfilledCallback</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ›´æ”¹å¤±è´¥åçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#82AAFF;">reject</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€æˆåŠŸä¸ºå¤±è´¥</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜å¤±è´¥åçš„åŸå› </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­å¤±è´¥å›è°ƒæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±è°ƒç”¨</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallback</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">onRejectedCallback</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æˆ‘ä»¬å†æ‰§è¡Œä¸€ä¸‹ä¸Šé¢çš„ç¨‹åº</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">setTimeout</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2000</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">reject</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ç­‰å¾… 2s è¾“å‡º resolve success</span></span>
<span class="line"></span></code></pre></div><p>ç›®å‰å·²ç»å¯ä»¥ç®€å•å¤„ç†å¼‚æ­¥é—®é¢˜äº†âœŒï¸</p><h2 id="ä¸‰ã€å®ç°thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨æ·»åŠ å¤šä¸ªå¤„ç†å‡½æ•°" tabindex="-1">ä¸‰ã€å®ç°thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨æ·»åŠ å¤šä¸ªå¤„ç†å‡½æ•° <a class="header-anchor" href="#ä¸‰ã€å®ç°thenæ–¹æ³•å¤šæ¬¡è°ƒç”¨æ·»åŠ å¤šä¸ªå¤„ç†å‡½æ•°" aria-hidden="true">#</a></h2><blockquote><p>&quot;Promiseçš„thenæ–¹æ³•æ˜¯å¯ä»¥è¢«å¤šæ¬¡è°ƒç”¨çš„ã€‚è¿™é‡Œå¦‚æœæœ‰ä¸‰ä¸ªthençš„è°ƒç”¨ï¼Œå¦‚æœæ˜¯åŒæ­¥å›è°ƒï¼Œé‚£ä¹ˆç›´æ¥è¿”å›å½“å‰çš„å€¼å°±è¡Œï¼›å¦‚æœæ˜¯å¼‚æ­¥å›è°ƒï¼Œé‚£ä¹ˆä¿å­˜çš„æˆåŠŸå¤±è´¥çš„å›è°ƒï¼Œéœ€è¦ç”¨ä¸åŒçš„å€¼ä¿å­˜ã€‚ä¹‹å‰çš„ä»£ç éœ€è¦æ”¹è¿›ã€‚&quot;</p></blockquote><p>åŒæ ·çš„å…ˆçœ‹ä¸€ä¸ªä¾‹å­</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">setTimeout</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2000</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">2</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 3</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// resolve success</span></span>
<span class="line"></span></code></pre></div><p>ç›®å‰çš„ä»£ç åªèƒ½è¾“å‡ºï¼š<strong>3 resolve success</strong>ï¼Œæ€ä¹ˆå¯ä»¥æŠŠ1ã€2å¼„ä¸¢å‘¢ï¼</p><p>æˆ‘ä»¬åº”è¯¥ä¸€è§†åŒä»ï¼Œä¿è¯æ‰€æœ‰thenä¸­çš„å›è°ƒå‡½æ•°éƒ½å¯ä»¥æ‰§è¡Œã€‚ç»§ç»­æ”¹é€ </p><h2 id="_1-mypromiseç±»ä¸­æ–°å¢ä¸¤ä¸ªæ•°ç»„" tabindex="-1">1.MyPromiseç±»ä¸­æ–°å¢ä¸¤ä¸ªæ•°ç»„ <a class="header-anchor" href="#_1-mypromiseç±»ä¸­æ–°å¢ä¸¤ä¸ªæ•°ç»„" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å­˜å‚¨æˆåŠŸå›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// onFulfilledCallback = null;</span></span>
<span class="line"><span style="color:#BABED8;">onFulfilledCallbacks </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å­˜å‚¨å¤±è´¥å›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// onRejectedCallback = null;</span></span>
<span class="line"><span style="color:#BABED8;">onRejectedCallbacks </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="_2-å›è°ƒå‡½æ•°å­˜å…¥æ•°ç»„ä¸­" tabindex="-1">2.å›è°ƒå‡½æ•°å­˜å…¥æ•°ç»„ä¸­ <a class="header-anchor" href="#_2-å›è°ƒå‡½æ•°å­˜å…¥æ•°ç»„ä¸­" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> onRejected) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­çŠ¶æ€</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨æˆåŠŸå›è°ƒï¼Œå¹¶ä¸”æŠŠå€¼è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å› ä¸ºä¸çŸ¥é“åé¢çŠ¶æ€çš„å˜åŒ–ï¼Œè¿™é‡Œå…ˆå°†æˆåŠŸå›è°ƒå’Œå¤±è´¥å›è°ƒå­˜å‚¨èµ·æ¥</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç­‰å¾…åç»­è°ƒç”¨</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="_3-å¾ªç¯è°ƒç”¨æˆåŠŸå’Œå¤±è´¥å›è°ƒ" tabindex="-1">3. å¾ªç¯è°ƒç”¨æˆåŠŸå’Œå¤±è´¥å›è°ƒ <a class="header-anchor" href="#_3-å¾ªç¯è°ƒç”¨æˆåŠŸå’Œå¤±è´¥å›è°ƒ" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ›´æ”¹æˆåŠŸåçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#82AAFF;">resolve</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€ä¿®æ”¹ä¸ºæˆåŠŸ</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜æˆåŠŸä¹‹åçš„å€¼</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// resolveé‡Œé¢å°†æ‰€æœ‰æˆåŠŸçš„å›è°ƒæ‹¿å‡ºæ¥æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">length</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// Array.shift() å–å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åï¼ˆï¼‰è°ƒç”¨ï¼Œshiftä¸æ˜¯çº¯å‡½æ•°ï¼Œå–å‡ºåï¼Œæ•°ç»„å°†å¤±å»è¯¥å…ƒç´ ï¼Œç›´åˆ°æ•°ç»„ä¸ºç©º</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">shift</span><span style="color:#F07178;">()(</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ›´æ”¹å¤±è´¥åçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#82AAFF;">reject</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€æˆåŠŸä¸ºå¤±è´¥</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜å¤±è´¥åçš„åŸå› </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// resolveé‡Œé¢å°†æ‰€æœ‰å¤±è´¥çš„å›è°ƒæ‹¿å‡ºæ¥æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">length</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">shift</span><span style="color:#F07178;">()(</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>å†æ¥è¿è¡Œä¸€ä¸‹ï¼Œçœ‹çœ‹ç»“æœğŸ‘‡</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#BABED8;">resolve success</span></span>
<span class="line"><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#BABED8;">resolve success</span></span>
<span class="line"><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#BABED8;">resolve success</span></span>
<span class="line"></span></code></pre></div><h2 id="å››ã€å®ç°thenæ–¹æ³•çš„é“¾å¼è°ƒç”¨" tabindex="-1">å››ã€å®ç°thenæ–¹æ³•çš„é“¾å¼è°ƒç”¨ <a class="header-anchor" href="#å››ã€å®ç°thenæ–¹æ³•çš„é“¾å¼è°ƒç”¨" aria-hidden="true">#</a></h2><blockquote><p>&quot;then æ–¹æ³•è¦é“¾å¼è°ƒç”¨é‚£ä¹ˆå°±éœ€è¦è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡</p><p>then æ–¹æ³•é‡Œé¢return ä¸€ä¸ªè¿”å›å€¼ä½œä¸ºä¸‹ä¸€ä¸ªthenæ–¹æ³•çš„å‚æ•°</p><p>å¦‚æœæ˜¯return ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œé‚£ä¹ˆå°±éœ€è¦åˆ¤æ–­å®ƒçš„çŠ¶æ€&quot;</p></blockquote><p>ä¸¾ä¸ªæ —å­</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ç›®å‰è¿™é‡Œåªå¤„ç†åŒæ­¥çš„é—®é¢˜</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">other</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">other</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">other</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">2</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre></div><p>ç”¨ç›®å‰çš„æ‰‹å†™ä»£ç è¿è¡Œçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œæ— æ³•é“¾å¼è°ƒç”¨</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">})</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">^</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">TypeError</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">Cannot</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">read</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">property</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">then</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">undefined</span></span>
<span class="line"></span></code></pre></div><p>æ¥ç€æ”¹ ğŸ’ª</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">......</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">then</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">onRejected</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä¸ºäº†é“¾å¼è°ƒç”¨è¿™é‡Œç›´æ¥åˆ›å»ºä¸€ä¸ª MyPromiseï¼Œå¹¶åœ¨åé¢ return å‡ºå»</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è¿™é‡Œçš„å†…å®¹åœ¨æ‰§è¡Œå™¨ä¸­ï¼Œä¼šç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">x</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­xæ˜¯ä¸æ˜¯ MyPromise å®ä¾‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æ‰§è¡Œ xï¼Œè°ƒç”¨ then æ–¹æ³•ï¼Œç›®çš„æ˜¯å°†å…¶çŠ¶æ€å˜ä¸º fulfilled æˆ–è€… rejected</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// x.then(value =&gt; resolve(value), reason =&gt; reject(reason))</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç®€åŒ–ä¹‹å</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æ™®é€šå€¼</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æ‰§è¡Œä¸€ä¸‹ï¼Œç»“æœğŸ‘‡</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#babed8;">1</span></span>
<span class="line"><span style="color:#babed8;">resolve success</span></span>
<span class="line"><span style="color:#babed8;">2</span></span>
<span class="line"><span style="color:#babed8;">resolve other</span></span>
<span class="line"><span style="color:#babed8;">å¤åˆ¶ä»£ç </span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>em... ç¬¦åˆé¢„æœŸ ğŸ˜</p><h2 id="äº”ã€thenæ–¹æ³•é“¾å¼è°ƒç”¨è¯†åˆ«promiseæ˜¯å¦è¿”å›è‡ªå·±" tabindex="-1">äº”ã€thenæ–¹æ³•é“¾å¼è°ƒç”¨è¯†åˆ«Promiseæ˜¯å¦è¿”å›è‡ªå·± <a class="header-anchor" href="#äº”ã€thenæ–¹æ³•é“¾å¼è°ƒç”¨è¯†åˆ«promiseæ˜¯å¦è¿”å›è‡ªå·±" aria-hidden="true">#</a></h2><blockquote><p>&quot;å¦‚æœthenæ–¹æ³•è¿”å›çš„æ˜¯è‡ªå·±çš„Promiseå¯¹è±¡ï¼Œåˆ™ä¼šå‘ç”Ÿå¾ªç¯è°ƒç”¨ï¼Œè¿™ä¸ªæ—¶å€™ç¨‹åºä¼šæŠ¥é”™&quot;</p></blockquote><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">100</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> p1 </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">p1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre></div><p>ä½¿ç”¨åŸç”ŸPromiseæ‰§è¡Œè¿™ä¸ªä»£ç ï¼Œä¼šæŠ¥ç±»å‹é”™è¯¯</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">100</span></span>
<span class="line"><span style="color:#82AAFF;">Uncaught</span><span style="color:#BABED8;"> (</span><span style="color:#89DDFF;">in</span><span style="color:#BABED8;"> promise) </span><span style="color:#FFCB6B;">TypeError</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Chaining cycle detected for promise #</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>æˆ‘ä»¬åœ¨MyPromiseå®ç°ä¸€ä¸‹</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">......</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">then</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">onRejected</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// resolvePromise é›†ä¸­å¤„ç†ï¼Œå°† promise2 ä¼ å…¥</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">x</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœç›¸ç­‰äº†ï¼Œè¯´æ˜returnçš„æ˜¯è‡ªå·±ï¼ŒæŠ›å‡ºç±»å‹é”™è¯¯å¹¶è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">TypeError</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Chaining cycle detected for promise #&lt;Promise&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æ‰§è¡Œä¸€ä¸‹ï¼Œç«Ÿç„¶æŠ¥é”™äº† ğŸ˜±</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">  </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#BABED8;">(promise2</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> x</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> reject)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">                       </span><span style="color:#89DDFF;">^</span></span>
<span class="line"><span style="color:#FFCB6B;">ReferenceError</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Cannot access </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">promise2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;"> before initialization</span></span>
<span class="line"></span></code></pre></div><p>ä¸ºå•¥ä¼šæŠ¥é”™å‘¢ï¼Ÿä»é”™è¯¯æç¤ºå¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å¿…é¡»è¦ç­‰ promise2 å®Œæˆåˆå§‹åŒ–ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦ç”¨ä¸Šå®å¾®ä»»åŠ¡å’Œäº‹ä»¶å¾ªç¯çš„çŸ¥è¯†äº†ï¼Œè¿™é‡Œå°±éœ€è¦åˆ›å»ºä¸€ä¸ªå¼‚æ­¥å‡½æ•°å»ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–ï¼Œå‰é¢æˆ‘ä»¬å·²ç»ç¡®è®¤äº†åˆ›å»ºå¾®ä»»åŠ¡çš„æŠ€æœ¯æ–¹æ¡ˆ --&gt; <code>queueMicrotask</code></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">......</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">then</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">onRejected</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)  </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">......</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">}</span></span>
<span class="line"></span></code></pre></div><p>æ‰§è¡Œä¸€ä¸‹</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// è¿™ä¸ªæ—¶å€™å°†promiseå®šä¹‰ä¸€ä¸ªp1ï¼Œç„¶åè¿”å›çš„æ—¶å€™è¿”å›p1è¿™ä¸ªpromise</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> p1 </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">p1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// è¿è¡Œçš„æ—¶å€™ä¼šèµ°reject</span></span>
<span class="line"><span style="color:#BABED8;">p1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">2</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">message</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre></div><p>è¿™é‡Œå¾—åˆ°æˆ‘ä»¬çš„ç»“æœ ğŸ‘‡</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#BABED8;">resolve success</span></span>
<span class="line"><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#BABED8;">Chaining cycle detected for promise #</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>å“ˆå“ˆï¼Œæå®š ğŸ˜ å¼€å§‹ä¸‹ä¸€æ­¥</p><h2 id="å…­ã€æ•è·é”™è¯¯åŠthené“¾å¼è°ƒç”¨å…¶ä»–çŠ¶æ€ä»£ç è¡¥å……" tabindex="-1">å…­ã€æ•è·é”™è¯¯åŠthené“¾å¼è°ƒç”¨å…¶ä»–çŠ¶æ€ä»£ç è¡¥å…… <a class="header-anchor" href="#å…­ã€æ•è·é”™è¯¯åŠthené“¾å¼è°ƒç”¨å…¶ä»–çŠ¶æ€ä»£ç è¡¥å……" aria-hidden="true">#</a></h2><p>ç›®å‰è¿˜ç¼ºå°‘é‡è¦çš„ä¸€ä¸ªç¯èŠ‚ï¼Œå°±æ˜¯æˆ‘ä»¬çš„é”™è¯¯æ•è·è¿˜æ²¡æœ‰å¤„ç†</p><p>1.æ•è·æ‰§è¡Œå™¨é”™è¯¯</p><blockquote><p>&quot;æ•è·æ‰§è¡Œå™¨ä¸­çš„ä»£ç ï¼Œå¦‚æœæ‰§è¡Œå™¨ä¸­æœ‰ä»£ç é”™è¯¯ï¼Œé‚£ä¹ˆPromiseçš„çŠ¶æ€è¦å˜ä¸ºå¤±è´¥&quot;</p></blockquote><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"><span style="color:#82AAFF;">constructor</span><span style="color:#BABED8;">(executor) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æ–°å¢</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// executoræ˜¯ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œè¿›å…¥ä¼šç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¹¶ä¼ å…¥resolveå’Œrejectæ–¹æ³•</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">executor</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// å¦‚æœæœ‰é”™è¯¯ï¼Œå°±ç›´æ¥æ‰§è¡Œreject</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>éªŒè¯ä¸€ä¸‹ï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// resolve(&#39;success&#39;)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">throw</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æ‰§è¡Œå™¨é”™è¯¯</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">2</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">message</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre></div><p>æ‰§è¡Œç»“æœ</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#BABED8;">æ‰§è¡Œå™¨é”™è¯¯</span></span>
<span class="line"></span></code></pre></div><p>2.thenæ‰§è¡Œæ—¶çš„é”™è¯¯æ•è·</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">onRejected) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä¸ºäº†é“¾å¼è°ƒç”¨è¿™é‡Œç›´æ¥åˆ›å»ºä¸€ä¸ªMyPromise,å¹¶åœ¨åé¢returnå‡ºå»</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­çŠ¶æ€</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾…promise2å®Œæˆåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">                </span><span style="color:#676E95;font-style:italic;">// æ–°å¢</span></span>
<span class="line"><span style="color:#F07178;">                </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">                    </span><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">                    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFullfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">                    </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥resolvePromiseé›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">                    </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">                </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">                    </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">                </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">           </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ç­‰å¾…</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// å› ä¸ºä¸çŸ¥é“åé¢çŠ¶æ€çš„å˜åŒ–æƒ…å†µï¼Œæ‰€ä»¥å°†æˆåŠŸå›è°ƒå’Œå¤±è´¥å›è°ƒå­˜å‚¨èµ·æ¥</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ç­‰åˆ°æ‰§è¡ŒæˆåŠŸå¤±è´¥å‡½æ•°çš„æ—¶å€™å†ä¼ é€’</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="ä¸ƒã€å‚è€ƒfulfilledçŠ¶æ€ä¸‹çš„å¤„ç†æ–¹å¼-å¯¹rejectedå’ŒpendingçŠ¶æ€è¿›è¡Œæ”¹é€ " tabindex="-1">ä¸ƒã€å‚è€ƒfulfilledçŠ¶æ€ä¸‹çš„å¤„ç†æ–¹å¼ï¼Œå¯¹rejectedå’ŒpendingçŠ¶æ€è¿›è¡Œæ”¹é€  <a class="header-anchor" href="#ä¸ƒã€å‚è€ƒfulfilledçŠ¶æ€ä¸‹çš„å¤„ç†æ–¹å¼-å¯¹rejectedå’ŒpendingçŠ¶æ€è¿›è¡Œæ”¹é€ " aria-hidden="true">#</a></h2><p><strong>[æ”¹é€ å†…å®¹åŒ…æ‹¬ï¼š]</strong></p><blockquote><ol><li>å¢åŠ å¼‚æ­¥çŠ¶æ€ä¸‹çš„é“¾å¼è°ƒç”¨</li><li>å¢åŠ å›è°ƒå‡½æ•°æ‰§è¡Œç»“æœçš„åˆ¤æ–­</li><li>å¢åŠ è¯†åˆ« Promise æ˜¯å¦è¿”å›è‡ªå·±</li><li>å¢åŠ é”™è¯¯æ•è·</li></ol></blockquote><p>â€‹</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> onRejected) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ä¸ºäº†é“¾å¼è°ƒç”¨è¿™é‡Œç›´æ¥åˆ›å»ºä¸€ä¸ª MyPromiseï¼Œå¹¶åœ¨åé¢ return å‡ºå»</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­çŠ¶æ€</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)  </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ç­‰å¾…</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å› ä¸ºä¸çŸ¥é“åé¢çŠ¶æ€çš„å˜åŒ–æƒ…å†µï¼Œæ‰€ä»¥å°†æˆåŠŸå›è°ƒå’Œå¤±è´¥å›è°ƒå­˜å‚¨èµ·æ¥</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ç­‰åˆ°æ‰§è¡ŒæˆåŠŸå¤±è´¥å‡½æ•°çš„æ—¶å€™å†ä¼ é€’</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> onRejected) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ä¸ºäº†é“¾å¼è°ƒç”¨è¿™é‡Œç›´æ¥åˆ›å»ºä¸€ä¸ª MyPromiseï¼Œå¹¶åœ¨åé¢ return å‡ºå»</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­çŠ¶æ€</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)  </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ç­‰å¾…</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å› ä¸ºä¸çŸ¥é“åé¢çŠ¶æ€çš„å˜åŒ–æƒ…å†µï¼Œæ‰€ä»¥å°†æˆåŠŸå›è°ƒå’Œå¤±è´¥å›è°ƒå­˜å‚¨èµ·æ¥</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ç­‰åˆ°æ‰§è¡ŒæˆåŠŸå¤±è´¥å‡½æ•°çš„æ—¶å€™å†ä¼ é€’</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ==== æ–°å¢ ====</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="å…«ã€thenä¸­çš„å‚æ•°å˜ä¸ºå¯é€‰" tabindex="-1">å…«ã€thenä¸­çš„å‚æ•°å˜ä¸ºå¯é€‰ <a class="header-anchor" href="#å…«ã€thenä¸­çš„å‚æ•°å˜ä¸ºå¯é€‰" aria-hidden="true">#</a></h2><p>ä¸Šé¢æˆ‘ä»¬å¤„ç† then æ–¹æ³•çš„æ—¶å€™éƒ½æ˜¯é»˜è®¤ä¼ å…¥ onFulfilledã€onRejected ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼Œä½†æ˜¯å®é™…ä¸ŠåŸç”Ÿ Promise æ˜¯å¯ä»¥é€‰æ‹©å‚æ•°çš„å•ä¼ æˆ–è€…ä¸ä¼ ï¼Œéƒ½ä¸ä¼šå½±å“æ‰§è¡Œã€‚</p><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§ ğŸ‘‡</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">100</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">promise</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">()</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">()</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">()</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(value))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// è¾“å‡º 100</span></span>
<span class="line"></span></code></pre></div><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ then æ–¹æ³•åšä¸€ç‚¹å°å°çš„è°ƒæ•´</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> onRejected) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœä¸ä¼ ï¼Œå°±ä½¿ç”¨é»˜è®¤å‡½æ•°</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;font-style:italic;">throw</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ä¸ºäº†é“¾å¼è°ƒç”¨è¿™é‡Œç›´æ¥åˆ›å»ºä¸€ä¸ª MyPromiseï¼Œå¹¶åœ¨åé¢ return å‡ºå»</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">......</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æ”¹é€ å®Œè‡ªç„¶æ˜¯éœ€è¦éªŒè¯ä¸€ä¸‹çš„</p><p><strong>å…ˆçœ‹æƒ…å†µä¸€</strong>ï¼šresolve ä¹‹å</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">succ</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(value))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ‰“å° succ</span></span>
<span class="line"></span></code></pre></div><p><strong>å…ˆçœ‹æƒ…å†µä¸€</strong>ï¼šreject ä¹‹å</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> promise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">err</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(value)</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(reason))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ‰“å° err</span></span>
<span class="line"></span></code></pre></div><p>å†™åˆ°è¿™é‡Œï¼Œéº»é›€ç‰ˆçš„ Promise åŸºæœ¬å®Œæˆäº†ï¼Œé¼“æŒ ğŸ‘ğŸ‘ğŸ‘</p><h2 id="ä¹ã€å®ç°resolveä¸rejectçš„é™æ€è°ƒç”¨" tabindex="-1">ä¹ã€å®ç°resolveä¸rejectçš„é™æ€è°ƒç”¨ <a class="header-anchor" href="#ä¹ã€å®ç°resolveä¸rejectçš„é™æ€è°ƒç”¨" aria-hidden="true">#</a></h2><p>å°±åƒå¼€å¤´æŒ‚çš„é‚£é“é¢è¯•é¢˜ä½¿ç”¨Â <code>return Promise.resolve</code>Â æ¥è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œæˆ‘ä»¬ç”¨ç°åœ¨çš„æ‰‹å†™ä»£ç å°è¯•ä¸€ä¸‹</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">MyPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">MyPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">4</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">res</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre></div><p>ç»“æœå®ƒæŠ¥é”™äº† ğŸ˜¥</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">MyPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">^</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">TypeError</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">MyPromise</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">resolve</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">is</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">not</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">a</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span></span>
<span class="line"></span></code></pre></div><p>é™¤äº† Promise.resolve è¿˜æœ‰ Promise.reject çš„ç”¨æ³•ï¼Œæˆ‘ä»¬éƒ½è¦å»æ”¯æŒï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">MyPromise </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">......</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// resolve é™æ€æ–¹æ³•</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">static</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">parameter</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¦‚æœä¼ å…¥ MyPromise å°±ç›´æ¥è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">parameter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">parameter</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è½¬æˆå¸¸è§„æ–¹å¼</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">parameter</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// reject é™æ€æ–¹æ³•</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">static</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>è¿™æ ·æˆ‘ä»¬å†æµ‹è¯•ä¸Šé¢çš„ ğŸŒ° å°±ä¸ä¼šæœ‰é—®é¢˜å•¦</p><p>æ‰§è¡Œç»“æœ ğŸ‘‡</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F78C6C;">4</span></span>
<span class="line"></span></code></pre></div><p>åˆ°è¿™é‡Œæ‰‹å†™å·¥ä½œå°±åŸºæœ¬å®Œæˆäº†ï¼Œå‰é¢ä¸»è¦ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæ‰€ä»¥æœ‰ä¸€äº›å†—ä½™ä»£ç ï¼Œæˆ‘è§„æ•´ä¸€ä¸‹</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å…ˆå®šä¹‰ä¸‰ä¸ªå¸¸é‡è¡¨ç¤ºçŠ¶æ€</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> PENDING </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pending</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> FULFILLED </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fulfilled</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> REJECTED </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rejected</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ–°å»º MyPromise ç±»</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">executor</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// executor æ˜¯ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œè¿›å…¥ä¼šç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¹¶ä¼ å…¥resolveå’Œrejectæ–¹æ³•</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">executor</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å‚¨å­˜çŠ¶æ€çš„å˜é‡ï¼Œåˆå§‹å€¼æ˜¯ pending</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">status</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> PENDING</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æˆåŠŸä¹‹åçš„å€¼</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">value</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¤±è´¥ä¹‹åçš„åŸå› </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">reason</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å­˜å‚¨æˆåŠŸå›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">onFulfilledCallbacks</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å­˜å‚¨å¤±è´¥å›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">onRejectedCallbacks</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æ›´æ”¹æˆåŠŸåçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">resolve</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€ä¿®æ”¹ä¸ºæˆåŠŸ</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜æˆåŠŸä¹‹åçš„å€¼</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// resolveé‡Œé¢å°†æ‰€æœ‰æˆåŠŸçš„å›è°ƒæ‹¿å‡ºæ¥æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">length</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// Array.shift() å–å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åï¼ˆï¼‰è°ƒç”¨ï¼Œshiftä¸æ˜¯çº¯å‡½æ•°ï¼Œå–å‡ºåï¼Œæ•°ç»„å°†å¤±å»è¯¥å…ƒç´ ï¼Œç›´åˆ°æ•°ç»„ä¸ºç©º</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">shift()(</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æ›´æ”¹å¤±è´¥åçš„çŠ¶æ€</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">reject</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// çŠ¶æ€æˆåŠŸä¸ºå¤±è´¥</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// ä¿å­˜å¤±è´¥åçš„åŸå› </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// resolveé‡Œé¢å°†æ‰€æœ‰å¤±è´¥çš„å›è°ƒæ‹¿å‡ºæ¥æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">length</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">shift()(</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">then</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">onRejected</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">realOnFulfilled</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onFulfilled</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">value</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">value</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">realOnRejected</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">onRejected</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;font-style:italic;">throw</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reason</span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä¸ºäº†é“¾å¼è°ƒç”¨è¿™é‡Œç›´æ¥åˆ›å»ºä¸€ä¸ª MyPromiseï¼Œå¹¶åœ¨åé¢ return å‡ºå»</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">fulfilledMicrotask</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">realOnFulfilled</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)  </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">rejectedMicrotask</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">queueMicrotask</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">realOnRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­çŠ¶æ€</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">FULFILLED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">fulfilledMicrotask</span><span style="color:#F07178;">() </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">REJECTED</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">rejectedMicrotask</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">PENDING</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ç­‰å¾…</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// å› ä¸ºä¸çŸ¥é“åé¢çŠ¶æ€çš„å˜åŒ–æƒ…å†µï¼Œæ‰€ä»¥å°†æˆåŠŸå›è°ƒå’Œå¤±è´¥å›è°ƒå­˜å‚¨èµ·æ¥</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ç­‰åˆ°æ‰§è¡ŒæˆåŠŸå¤±è´¥å‡½æ•°çš„æ—¶å€™å†ä¼ é€’</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onFulfilledCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">fulfilledMicrotask</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">onRejectedCallbacks</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">rejectedMicrotask</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">promise2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// resolve é™æ€æ–¹æ³•</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">resolve</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">parameter</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¦‚æœä¼ å…¥ MyPromise å°±ç›´æ¥è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">parameter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">parameter</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è½¬æˆå¸¸è§„æ–¹å¼</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">parameter</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// reject é™æ€æ–¹æ³•</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">reject</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">reason</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">reason</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">promise2</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">x</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœç›¸ç­‰äº†ï¼Œè¯´æ˜returnçš„æ˜¯è‡ªå·±ï¼ŒæŠ›å‡ºç±»å‹é”™è¯¯å¹¶è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">promise2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">TypeError</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Chaining cycle detected for promise #&lt;Promise&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­xæ˜¯ä¸æ˜¯ MyPromise å®ä¾‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">MyPromise</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æ‰§è¡Œ xï¼Œè°ƒç”¨ then æ–¹æ³•ï¼Œç›®çš„æ˜¯å°†å…¶çŠ¶æ€å˜ä¸º fulfilled æˆ–è€… rejected</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// x.then(value =&gt; resolve(value), reason =&gt; reject(reason))</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç®€åŒ–ä¹‹å</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æ™®é€šå€¼</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> MyPromise</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>åˆ°è¿™ä¸€æ­¥æ‰‹å†™éƒ¨åˆ†åŸºæœ¬å¤§åŠŸå‘Šæˆ ğŸ‰ğŸ‰ğŸ‰</p><h2 id="promise-a-æµ‹è¯•" tabindex="-1">Promise A+ æµ‹è¯• <a class="header-anchor" href="#promise-a-æµ‹è¯•" aria-hidden="true">#</a></h2><p>ä¸Šé¢ä»‹ç»äº† Promise A+ è§„èŒƒï¼Œå½“ç„¶æˆ‘ä»¬æ‰‹å†™çš„ç‰ˆæœ¬ä¹Ÿå¾—ç¬¦åˆäº†è¿™ä¸ªè§„èŒƒæ‰æœ‰èµ„æ ¼å« Promiseï¼Œ ä¸ç„¶å°±åªèƒ½æ˜¯ä¼ª Promise äº†ã€‚</p><p>ä¸Šæ–‡è®²åˆ°äº† <code>promises-aplus-tests</code>ï¼Œç°åœ¨æˆ‘ä»¬æ­£å¼å¼€ç®±ä½¿ç”¨</p><h2 id="_1-å®‰è£…ä¸€ä¸‹" tabindex="-1">1. å®‰è£…ä¸€ä¸‹ <a class="header-anchor" href="#_1-å®‰è£…ä¸€ä¸‹" aria-hidden="true">#</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#babed8;">npm install promises-aplus-tests -D</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><h2 id="_2-æ‰‹å†™ä»£ç ä¸­åŠ å…¥-deferred" tabindex="-1">2. æ‰‹å†™ä»£ç ä¸­åŠ å…¥ deferred <a class="header-anchor" href="#_2-æ‰‹å†™ä»£ç ä¸­åŠ å…¥-deferred" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">MyPromise </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">......</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">MyPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deferred</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">result</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">promise</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#F07178;">(</span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">result</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">resolve</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">result</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">reject</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">result</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> MyPromise</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="_3-é…ç½®å¯åŠ¨å‘½ä»¤" tabindex="-1">3. é…ç½®å¯åŠ¨å‘½ä»¤ <a class="header-anchor" href="#_3-é…ç½®å¯åŠ¨å‘½ä»¤" aria-hidden="true">#</a></h2><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">promise</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">my promise</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">main</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">MyPromise.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">promises-aplus-tests MyPromise</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">author</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ITEM</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">license</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ISC</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devDependencies</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">promises-aplus-tests</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">^2.1.2</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>å¼€å¯æµ‹è¯•</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">npm run test</span></span>
<span class="line"></span></code></pre></div><p>è¿«ä¸åŠå¾…äº†å§ ğŸ˜„ çœ‹çœ‹æˆ‘ä»¬çš„ç»“æœå¦‚ä½•ï¼Œèµ°èµ· ğŸ±â€ğŸ</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0b6b60d615564bf892084c277f2e111b~tplv-k3u1fbpfcp-watermark.image" alt="fail.gif"></p><p>è™½ç„¶åŠŸèƒ½ä¸Šæ²¡å•¥é—®é¢˜ï¼Œä½†æ˜¯æµ‹è¯•å´å¤±è´¥äº† ğŸ˜¥</p><p>é’ˆå¯¹æç¤ºä¿¡æ¯ï¼Œæˆ‘ç¿»çœ‹äº†ä¸€ä¸‹ Promise A+ è§„èŒƒï¼Œå‘ç°æˆ‘ä»¬åº”è¯¥æ˜¯åœ¨ 2.3.x ä¸Šå‡ºç°äº†é—®é¢˜ï¼Œè¿™é‡Œè§„èŒƒä½¿ç”¨äº†ä¸åŒçš„æ–¹å¼è¿›è¡Œäº† then çš„è¿”å›å€¼åˆ¤æ–­ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/535045144acb4d7794d05569b231e892~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>è‡ªçº¢çº¿å‘ä¸‹çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬éƒ½æ²¡æœ‰å¤„ç†ï¼Œè¿™é‡Œè¦æ±‚åˆ¤æ–­ x æ˜¯å¦ä¸º object æˆ–è€… functionï¼Œæ»¡è¶³åˆ™æ¥ç€åˆ¤æ–­ x.then æ˜¯å¦å­˜åœ¨ï¼Œè¿™é‡Œå¯ä»¥ç†è§£ä¸ºåˆ¤æ–­ x æ˜¯å¦ä¸º promiseï¼Œè¿™é‡Œéƒ½åŠŸèƒ½å®é™…ä¸æˆ‘ä»¬æ‰‹å†™ç‰ˆæœ¬ä¸­ <code>x instanceof MyPromise</code> åŠŸèƒ½ç›¸ä¼¼ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯æŒ‰ç…§è§„èŒƒæ”¹é€ ä¸€ä¸‹ <code>resolvePromise</code> æ–¹æ³•å§</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">promise</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">x</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœç›¸ç­‰äº†ï¼Œè¯´æ˜returnçš„æ˜¯è‡ªå·±ï¼ŒæŠ›å‡ºç±»å‹é”™è¯¯å¹¶è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">promise</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">TypeError</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">The promise and the return value are the same</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">object</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// x ä¸º null ç›´æ¥è¿”å›ï¼Œèµ°åé¢çš„é€»è¾‘ä¼šæŠ¥é”™</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">then</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// æŠŠ x.then èµ‹å€¼ç»™ then </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#BABED8;">then</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">then</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å¦‚æœå– x.then çš„å€¼æ—¶æŠ›å‡ºé”™è¯¯ error ï¼Œåˆ™ä»¥ error ä¸ºæ®å› æ‹’ç» promise</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ then æ˜¯å‡½æ•°</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">then</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">called</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#BABED8;">then</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// this æŒ‡å‘ x</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ resolvePromise ä»¥å€¼ y ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™è¿è¡Œ [[Resolve]](promise, y)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;font-style:italic;">y</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ resolvePromise å’Œ rejectPromise å‡è¢«è°ƒç”¨ï¼Œ</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// æˆ–è€…è¢«åŒä¸€å‚æ•°è°ƒç”¨äº†å¤šæ¬¡ï¼Œåˆ™ä¼˜å…ˆé‡‡ç”¨é¦–æ¬¡è°ƒç”¨å¹¶å¿½ç•¥å‰©ä¸‹çš„è°ƒç”¨</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// å®ç°è¿™æ¡éœ€è¦å‰é¢åŠ ä¸€ä¸ªå˜é‡ called</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">called</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#BABED8;">called</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">y</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ rejectPromise ä»¥æ®å›  r ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™ä»¥æ®å›  r æ‹’ç» promise</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;font-style:italic;">r</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">called</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#BABED8;">called</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">r</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// å¦‚æœè°ƒç”¨ then æ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ errorï¼š</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ resolvePromise æˆ– rejectPromise å·²ç»è¢«è°ƒç”¨ï¼Œç›´æ¥è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">called</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// å¦åˆ™ä»¥ error ä¸ºæ®å› æ‹’ç» promise</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ then ä¸æ˜¯å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ promise</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ x ä¸ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ promise</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æ”¹é€ åå¯åŠ¨æµ‹è¯•</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c62e0df759748eb97b453ff94492877~tplv-k3u1fbpfcp-watermark.image" alt="success.gif"></p><p>å®Œç¾é€šè¿‡ ğŸ‘ğŸ‘ğŸ‘</p><h2 id="æœ€ç»ˆæ—¶åˆ»-å¦‚ä½•è§£é‡Šé‚£é“é¢è¯•é¢˜çš„æ‰§è¡Œç»“æœ" tabindex="-1">æœ€ç»ˆæ—¶åˆ»ï¼Œå¦‚ä½•è§£é‡Šé‚£é“é¢è¯•é¢˜çš„æ‰§è¡Œç»“æœ <a class="header-anchor" href="#æœ€ç»ˆæ—¶åˆ»-å¦‚ä½•è§£é‡Šé‚£é“é¢è¯•é¢˜çš„æ‰§è¡Œç»“æœ" aria-hidden="true">#</a></h2><p>å…ˆç”¨æˆ‘ä»¬è‡ªå·±çš„ Promise è¿è¡Œä¸€ä¸‹é‚£é“é¢è¯•é¢˜ ğŸ‘‡</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// test.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> MyPromise </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./MyPromise.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">MyPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">MyPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">4</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">res</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">MyPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">2</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">5</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">6</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre></div><p>æ‰§è¡Œç»“æœï¼š<strong>0ã€1ã€2ã€4ã€3ã€5ã€6</strong> ğŸ¤¯</p><p>è¿™é‡Œæˆ‘ä»¬æ‰‹å†™ç‰ˆæœ¬çš„ 4 å¹¶æ²¡æœ‰å’Œ åŸç”Ÿ Promise ä¸€æ ·åœ¨ 3 åé¢ï¼Œè€Œæ˜¯åœ¨ 2 åé¢</p><p>å…¶å®ä»æˆ‘ä»¬çš„æ‰‹å†™ä»£ç ä¸Šçœ‹ï¼Œåœ¨åˆ¤æ–­ then å†…éƒ¨å‡½æ•°æ‰§è¡Œç»“æœï¼Œä¹Ÿå°±æ˜¯åœ¨è¿™é‡Œ ğŸ‘‡</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// MyPromise.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> x </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">realOnFulfilled</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">value)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†</span></span>
<span class="line"><span style="color:#82AAFF;">resolvePromise</span><span style="color:#BABED8;">(promise2</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> x</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> resolve</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> reject)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>é¢è¯•é¢˜ä¸­ x ä¸º <code>MyPromise.resolve(4)</code> çš„æ—¶å€™ï¼Œåœ¨ä¼ å…¥ resolvePromise æ–¹æ³•ä¸­ä¼šå¯¹ x çš„ç±»å‹è¿›è¡Œåˆ¤æ–­æ—¶ï¼Œä¼šå‘ç°å®ƒæ˜¯ä¸€ä¸ª Promiseï¼Œå¹¶è®©å…¶è°ƒç”¨ then æ–¹æ³•å®ŒæˆçŠ¶æ€è½¬æ¢ã€‚å†çœ‹ resolvePromis æ–¹æ³•ä¸­è¿™ä¸€å—åˆ¤æ–­é€»è¾‘ ğŸ‘‡</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> (</span><span style="color:#89DDFF;">typeof</span><span style="color:#BABED8;"> x </span><span style="color:#89DDFF;">===</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">object</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">||</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#BABED8;"> x </span><span style="color:#89DDFF;">===</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// x ä¸º null ç›´æ¥è¿”å›ï¼Œèµ°åé¢çš„é€»è¾‘ä¼šæŠ¥é”™</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">x</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">then</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// æŠŠ x.then èµ‹å€¼ç»™ then </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#BABED8;">then</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">then</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å¦‚æœå– x.then çš„å€¼æ—¶æŠ›å‡ºé”™è¯¯ error ï¼Œåˆ™ä»¥ error ä¸ºæ®å› æ‹’ç» promise</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">error</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ then æ˜¯å‡½æ•°</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">then</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">called</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#BABED8;">then</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">x</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// this æŒ‡å‘ x</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ resolvePromise ä»¥å€¼ y ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™è¿è¡Œ [[Resolve]](promise, y)</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;font-style:italic;">y</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ resolvePromise å’Œ rejectPromise å‡è¢«è°ƒç”¨ï¼Œ</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// æˆ–è€…è¢«åŒä¸€å‚æ•°è°ƒç”¨äº†å¤šæ¬¡ï¼Œåˆ™ä¼˜å…ˆé‡‡ç”¨é¦–æ¬¡è°ƒç”¨å¹¶å¿½ç•¥å‰©ä¸‹çš„è°ƒç”¨</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// å®ç°è¿™æ¡éœ€è¦å‰é¢åŠ ä¸€ä¸ªå˜é‡ called</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">called</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#BABED8;">called</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">resolvePromise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">promise</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">y</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">reject</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ rejectPromise ä»¥æ®å›  r ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™ä»¥æ®å›  r æ‹’ç» promise</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;font-style:italic;">r</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">called</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#BABED8;">called</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">r</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">......</span><span style="color:#F07178;">   </span></span>
<span class="line"></span></code></pre></div><p>é‚£ä¹ˆé—®é¢˜æ¥äº†</p><ul><li><strong>ä¸ºä»€ä¹ˆæˆ‘ä»¬ Promise A+ æµ‹è¯•å…¨éƒ¨é€šè¿‡çš„æ‰‹å†™ä»£ç ï¼Œæ‰§è¡Œç»“æœå´ä¸åŸç”Ÿ Promise ä¸åŒï¼Ÿ</strong></li><li><strong>åœ¨æˆ‘ä»¬æ‰‹å†™ä»£ç ä½¿ç”¨åˆ›å»ºä¸€æ¬¡å¾®ä»»åŠ¡çš„æ–¹å¼ï¼Œä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</strong></li></ul><p>ES6 ä¸­çš„ Promise è™½ç„¶æ˜¯éµå¾ª Promise A+ è§„èŒƒå®ç°çš„ï¼Œä½†å®é™…ä¸Šä¹Ÿ Promise A+ ä¸Šåšäº†ä¸€äº›åŠŸèƒ½æ‰©å±•ï¼Œä¾‹å¦‚ï¼šPromise.allã€Promise.race ç­‰ï¼Œæ‰€ä»¥å³ä½¿éƒ½ç¬¦åˆ Promise A+ ï¼Œæ‰§è¡Œç»“æœä¹Ÿæ˜¯å¯èƒ½å­˜åœ¨å·®å¼‚çš„ã€‚æˆ‘ä»¬è¿™é‡Œæ›´éœ€è¦æ€è€ƒçš„æ˜¯ç¬¬äºŒä¸ªé—®é¢˜ï¼Œ<strong>ä¸è¿™ä¹ˆåšä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯åŠ ä¸€æ¬¡å¾®ä»»åŠ¡çš„å¿…è¦æ€§ã€‚</strong></p><p>æˆ‘å°è¯•è¿‡å¾ˆå¤šä¾‹å­ï¼Œéƒ½æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ä¾‹è¯ï¼Œæˆ‘ä»¬æ‰‹å†™å®ç°çš„ Promise éƒ½å¾ˆå¥½çš„å®Œæˆå·¥ä½œï¼Œæ‹¿åˆ°äº†ç»“æœã€‚æˆ‘ä¸å¾—ä¸å»ç¿»çœ‹æ›´å¤šçš„ç›¸å…³æ–‡ç« ï¼Œæˆ‘å‘ç°æœ‰äº›äººä¼šä¸ºäº†è®©æ‰§è¡Œç»“æœä¸åŸç”Ÿç›¸åŒï¼Œå¼ºè¡Œå»å†å¤šåŠ ä¸€æ¬¡å¾®ä»»åŠ¡ï¼Œè¿™ç§åšæ³•æ˜¯å¾ˆç‰µå¼ºçš„ã€‚</p><p>æ¯•ç«Ÿå®ç° Promise çš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³å¼‚æ­¥ç¼–ç¨‹çš„é—®é¢˜ï¼Œèƒ½å¤Ÿæ‹¿åˆ°æ­£ç¡®çš„ç»“æœæ‰æ˜¯æœ€é‡è¦çš„ï¼Œå¼ºè¡Œä¸ºäº†ç¬¦åˆé¢è¯•é¢˜çš„è¾“å‡ºé¡ºåºå»å¤šåŠ ä¸€æ¬¡å¾®ä»»åŠ¡ï¼Œåªèƒ½è®©æ‰‹å†™ä»£ç å˜çš„æ›´åŠ å¤æ‚ï¼Œä¸å¥½ç†è§£ã€‚</p><p>åœ¨ stackoverflow ä¸Šï¼Œæœ‰ä¸€ä¸ªç±»ä¼¼çš„é—®é¢˜ <a href="https://stackoverflow.com/questions/58217603/what-is-the-difference-between-returned-promise" target="_blank" rel="noreferrer">What is the difference between returned Promise?</a> å›ç­”ä¸­æœ‰ä¸€ä¸ªä¿¡æ¯å°±æ˜¯</p><blockquote><p><code>It only required the execution context stack contains only platform code.</code> ä¹Ÿå°±ç›¸å½“äºç­‰å¾… <code>execution context stack</code> æ¸…ç©ºã€‚</p></blockquote><p>è¿™ä¸ªåœ¨æ˜é‡‘ä¸­çš„ä¸€ç¯‡æ–‡ç«  <a href="https://juejin.cn/post/6937076967283884040" target="_blank" rel="noreferrer">æˆ‘ä»¥ä¸ºæˆ‘å¾ˆæ‡‚Promiseï¼Œç›´åˆ°æˆ‘å¼€å§‹å®ç°Promise/A+è§„èŒƒ</a> ä¹Ÿæœ‰ä¸€æ®µå…³äºè¿™é“é¢è¯•é¢˜çš„è®¨è®º</p><blockquote><p><code>return Promise.resolve(4)</code>ï¼ŒJSå¼•æ“ä¼šå®‰æ’ä¸€ä¸ªjobï¼ˆjobæ˜¯ ECMA ä¸­çš„æ¦‚å¿µï¼Œç­‰åŒäºå¾®ä»»åŠ¡çš„æ¦‚å¿µ)ï¼Œå…¶å›è°ƒç›®çš„æ˜¯è®©å…¶çŠ¶æ€å˜ä¸ºfulfilledã€‚</p></blockquote><p>å®é™…ä¸Šæˆ‘ä»¬å·²ç»åœ¨ <code>static resolve</code> åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ MyPromsieï¼Œå¹¶è°ƒç”¨å…¶ then æ–¹æ³•ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå¾®ä»»åŠ¡ã€‚</p><p>æ‰€ä»¥ï¼Œå°±ç›®å‰çš„ä¿¡æ¯æ¥è¯´ï¼Œä¸¤æ¬¡å¾®ä»»åŠ¡ä¾æ—§ä¸èƒ½è¯æ˜å…¶å¿…è¦æ€§ï¼Œç›®å‰çš„ Promise æ—¥å¸¸æ“ä½œï¼Œä¸€æ¬¡å¾®ä»»åŠ¡éƒ½æ˜¯å¯ä»¥æ»¡è¶³ã€‚</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-a18e9499 data-v-c95b7433><!----><div class="prev-next" data-v-c95b7433><div class="pager" data-v-c95b7433><a class="pager-link prev" href="/interview/javascript/%E5%A6%82%E4%BD%95%E5%86%99%E5%87%BA%E4%B8%80%E4%B8%AA%E6%83%8A%E8%89%B3%E9%9D%A2%E8%AF%95%E5%AE%98%E7%9A%84%E6%B7%B1%E6%8B%B7%E8%B4%9D%EF%BC%9F.html" data-v-c95b7433><span class="desc" data-v-c95b7433>Previous page</span><span class="title" data-v-c95b7433>å¦‚ä½•å†™å‡ºä¸€ä¸ªæƒŠè‰³é¢è¯•å®˜çš„æ·±æ‹·è´ï¼Ÿ </span></a></div><div class="has-prev pager" data-v-c95b7433><a class="pager-link next" href="/interview/javascript/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E9%97%AD%E5%8C%85%E2%80%94[%E4%BD%9C%E7%94%A8%E5%9F%9F]%E5%92%8C[%E4%B8%8A%E4%B8%8B%E6%96%87%E7%8E%AF%E5%A2%83].html" data-v-c95b7433><span class="desc" data-v-c95b7433>Next page</span><span class="title" data-v-c95b7433>æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”[ä½œç”¨åŸŸ]å’Œ[ä¸Šä¸‹æ–‡ç¯å¢ƒ]</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-5e6dadf6 data-v-03f53767><div class="container" data-v-03f53767><p class="message" data-v-03f53767>å…´è¶£ä¸å·¥ä½œç›¸ç»“åˆ</p><p class="copyright" data-v-03f53767> Copyright Â© äº¬ICPå¤‡18000331å·-1</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"algorithm_binarytree_äºŒå‰æ ‘ä¸ç»å…¸é—®é¢˜ï¼ˆä¸€ï¼‰.md\":\"949bfd42\",\"algorithm_binarytree_äºŒå‰æ ‘ä¸ç»å…¸é—®é¢˜ï¼ˆä¸‰ï¼‰.md\":\"2cc6e346\",\"interview_javascript_function.prototype.bind.md\":\"c4cd9fb1\",\"japanese_ãŠã‚“ã›ã„_05.æ‹—éŸ³ç³»åˆ—ï¼Œé•¿éŸ³.md\":\"93935616\",\"interview_javascript_javascriptä¸­proxyå’Œdefinepropertyå¯¹æ¯”.md\":\"0e60dbc4\",\"interview_vue-router_readme.md\":\"912bd292\",\"backend_linux_linuxå¸¸ç”¨å‘½ä»¤.md\":\"80ede831\",\"japanese_ãã‚‡ã†ã’ãã¨ã‹ã¶ã_06.ãã‚Œã§ã€ï½–ã¦ã„ã¦.md\":\"95b686f4\",\"algorithm_stack_é€’å½’ä¸æ ˆå…¸å‹åº”ç”¨åœºæ™¯ï¼ˆä¸€ï¼‰.md\":\"3ee88068\",\"interview_javascript_é˜²æŠ–å’ŒèŠ‚æµåŸç†åˆ†æâ€”é˜²æŠ–.md\":\"ab0e2c78\",\"source_vue3_50-å®ç°ä»£ç ç”Ÿæˆæ’å€¼ç±»å‹.md\":\"28d90480\",\"japanese_ã—ã‚“ã›ã„ã‹ã¤_02.ã‹ã€ã¯ã„ã€ãˆãˆã€ã„ã„ãˆã€ã®....md\":\"7a1e0f21\",\"source_vue3_45-å®ç°è§£æ text åŠŸèƒ½.md\":\"00b3eb13\",\"vue_index.md\":\"72d61862\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ç®€è¿°ã€æ‰§è¡Œä¸Šä¸‹æ–‡ã€‘ä¸Š.md\":\"516dac1d\",\"source_vue3_52-å®ç°ç¼–è¯‘ template æˆ render å‡½æ•°.md\":\"b3d60094\",\"source_vue3_49-å®ç°ä»£ç ç”Ÿæˆ string ç±»å‹.md\":\"c87d7e46\",\"japanese_ãŠã‚“ã›ã„_04.ã¡ã‚è¡Œï¼ŒæµŠéŸ³ç³»åˆ—ï¼Œä¿ƒéŸ³.md\":\"38ec87b3\",\"source_vue3_53-å®ç° monorepo.md\":\"65b2e53c\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”éšå¼åŸå‹.md\":\"21759b65\",\"source_vue3_48-å®ç° transform åŠŸèƒ½.md\":\"37c4ff9e\",\"japanese_ã—ã‚“ã›ã„ã‹ã¤_03.ã¡ã¡ã€ã¯ã¯ã€ã‚ã«ã€ã„ã‚‚....md\":\"c203b83a\",\"blog_2023å‰ç«¯å·²æ­»æ€ä¹ˆåŠï¼Ÿ.md\":\"abc640f6\",\"source_vue3_46-å®ç°è§£æä¸‰ç§è”åˆç±»å‹.md\":\"a90bd390\",\"japanese_ãŠã‚“ã›ã„_03.ã¯ã¾ã‚„è¡Œï¼Œâ‘¢â‘£...è°ƒï¼Œæ‹¨éŸ³.md\":\"cbfc7305\",\"interview_javascript_javascriptè®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼.md\":\"d469348c\",\"japanese_ã‹ã„ã‚‚ã®_06.vã‚‹ã“ã¨ãŒã§ãã‚‹ã€ãšã¤.md\":\"34b1c4a3\",\"algorithm_chaintable_é“¾è¡¨å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆäºŒï¼‰.md\":\"2a96074d\",\"source_vue3_51-å®ç°ä»£ç ç”Ÿæˆä¸‰ç§è”åˆç±»å‹.md\":\"1fd25e11\",\"japanese_ãã‚‡ã†ã’ãã¨ã‹ã¶ã_04.ã©ã¡ã‚‰ã‚‚ã€ãªã‹ãªã‹ã€ã®...md\":\"be184e3f\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ä»_è‡ªç”±å˜é‡_åˆ°_ä½œç”¨åŸŸé“¾_.md\":\"d73e0ab4\",\"source_vue3_44-å®ç°è§£æ element.md\":\"17778638\",\"japanese_ãŒãã›ã„ã›ã„ã‹ã¤_03.ã¦ã„ã‚‹ã€ãŒã‚‹ã€ã‚‚ã†ãŸã€ã¾ã ...md\":\"40ed6e46\",\"japanese_ãŒãã›ã„ã›ã„ã‹ã¤_01.ã¦ã€ã¦ã„ã‚‹ã€ã¦ã„ãŸã¾ã—ã‚‡...md\":\"edd3bee9\",\"japanese_ã—ã‚“ã›ã„ã‹ã¤_04.ã„ã¡ã€ã«ã‚“ã€ã²ã¨ã¤....md\":\"3b5dcdf3\",\"japanese_ã‚ã‚“ãªã„_05.ã§ã€ã«ã™ã‚‹ã€ã‹ã„ã‚.md\":\"2fac574d\",\"japanese_ãã‚‡ã†ã’ãã¨ã‹ã¶ã_02.ã‘ã©ã€n2ã‚ˆã‚Šn1ã®ã»ã†ãŒ.md\":\"e038a065\",\"japanese_ã‹ã„ã‚‚ã®_02.nãŒã»ã—ã„ã€nãŒã§ãã‚‹..md\":\"d12f7bbc\",\"japanese_ãã‚‡ã†ã’ãã¨ã‹ã¶ã_03.ã«ã€ã ã‘ãªãã€ãŒã„ã¡ã°ã‚“..md\":\"71539161\",\"algorithm_stack_é€’å½’ä¸æ ˆå…¸å‹åº”ç”¨åœºæ™¯ï¼ˆäºŒï¼‰.md\":\"d55e1366\",\"japanese_ã‹ã„ã‚‚ã®_01.vãŸã„.md\":\"9c4fc686\",\"interview_javascript_é˜²æŠ–å’ŒèŠ‚æµåŸç†åˆ†æâ€”èŠ‚æµ.md\":\"ad962450\",\"algorithm_index.md\":\"c3996e97\",\"japanese_ã—ã‚“ã›ã„ã‹ã¤_05.ã‹ã€ã­ã‚“ã›ã„ã€ã•ã„ã€ã¨....md\":\"8d092806\",\"japanese_ãŸã‹ã¯ã—ã®ã‚Šã‚…ã†ãŒãã›ã„ã‹ã¤_02.ãŒã€ãŸã©ã™.md\":\"2d4df6a6\",\"japanese_ãŸã‹ã¯ã—ã®ã‚Šã‚…ã†ãŒãã›ã„ã‹ã¤_01.ã©ã†ã—ã€ã‚’...md\":\"7ae7cb1f\",\"japanese_ãŸã‹ã¯ã—ã®ã‚Šã‚…ã†ãŒãã›ã„ã‹ã¤_03.ã»ã¨ã‚“ã©ã€ã„ã¤ã‚‚ã€ã§....md\":\"7f367fc4\",\"japanese_ãŸã‹ã¯ã—ã®ã‚Šã‚…ã†ãŒãã›ã„ã‹ã¤_04.ã‚ã¨ï¼ˆã§ï¼‰ã«ã€ã¨ã‹.md\":\"041af2ce\",\"japanese_ã«ã»ã‚“ã”ã®ã¹ã‚“ãã‚‡ã†_01.ã‹ã‚ã„ã€ãã‚‰ã„ã€ã‚†ã†ã‚ã„....md\":\"ec3a8a39\",\"backend_index.md\":\"5d5385bb\",\"japanese_ã—ã‚“ã›ã„ã‹ã¤_06.ã­ã‚“ã€ã®....md\":\"cfeb4e93\",\"japanese_ã«ã»ã‚“ã”ã®ã¹ã‚“ãã‚‡ã†_05.ã¯ãŒã€ã¯ã€ãŒ...md\":\"293db669\",\"japanese_ãŸã‹ã¯ã—ã®ã‚Šã‚…ã†ãŒãã›ã„ã‹ã¤_05.ã«ã€ã‚ã¾ã‚Šã€ã‚ã‚“ã‘ãƒ¼ã¨.md\":\"dcbe8b21\",\"japanese_ã«ã»ã‚“ã”ã®ã¹ã‚“ãã‚‡ã†_04.ãŒã€ã¯ã€ã‚‚ã‚‚ã€ã‚ˆã€ã®ã¨ã....md\":\"f55a863e\",\"japanese_ã«ã»ã‚“ã”ã®ã¹ã‚“ãã‚‡ã†_06.ãã¦ã§ã€ã ã‹ã‚‰...md\":\"623ca7bf\",\"algorithm_chaintable_é“¾è¡¨å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆä¸‰ï¼‰.md\":\"cab4dc29\",\"japanese_ã‚ã‚“ãªã„_02.ã ã„ã€ã¯ã„ã€ã²ãã€ã‚“ã§ã™ã‹.md\":\"c06fd170\",\"japanese_ã¼ã†ã­ã‚“ã‹ã„_02.ã‹ã©ã†ã‹ã€ãŸã“ã¨ãŒã‚ã‚‹....md\":\"e271a686\",\"japanese_ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹.ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«_01.ã‘ã„ã‚ˆã†ã—ã€ã“ãã‚ã©ã€ã‚‚...md\":\"fcc8490d\",\"japanese_ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹.ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«_02.ã˜ã€ãµã‚“ã€ã˜ã¯ã‚“.md\":\"cf9fd9c6\",\"japanese_ã«ã»ã‚“ã”ã®ã¹ã‚“ãã‚‡ã†_02.ãŒã€ãã‚“ãªã«ã€ã‚ã¾ã‚Š...md\":\"fca6b6f6\",\"japanese_ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹.ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«_04.ã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ã‹ã€ã©...md\":\"09e55f52\",\"japanese_ã‚¹ãƒ”ãƒ¼ãƒã‚³ãƒ³ãƒ†ã‚¹ãƒˆå¿œæ´_03.ã‚¹ãƒ”ãƒ¼ãƒã‚³ãƒ³ãƒ†ã‚¹ãƒˆ.md\":\"d1d71168\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”å‡½æ•°å’Œå¯¹è±¡çš„å…³ç³».md\":\"a95c1833\",\"japanese_ã‚¹ãƒ”ãƒ¼ãƒã‚³ãƒ³ãƒ†ã‚¹ãƒˆå¿œæ´_02.ã‹ã€ã‚‚ã€ã©ã“ã‚ã§ã€n1ã‹n2.md\":\"aec9c839\",\"japanese_ã¼ã†ã­ã‚“ã‹ã„_04.ãŸã‚Šã€ãŸã‚Šã™ã‚‹ã€é€šã˜ã¦.md\":\"59835c38\",\"japanese_ã‚¹ãƒ”ãƒ¼ãƒã‚³ãƒ³ãƒ†ã‚¹ãƒˆå¿œæ´_05.ã«ã€ãã—ã¦ã€ã¨ã€ã¸ã€ã¾ã›ã‚“...md\":\"88aa03c9\",\"japanese_ãƒ«ãƒ¼ãƒ«ã¨ãƒãƒŠãƒ¼_01.ã‚‚ã„ã„ã€ã¯ã„ã‘ãªã„ã€ã‹ã‚‰...md\":\"81f43497\",\"source_index.md\":\"298e7f5e\",\"japanese_ãƒ«ãƒ¼ãƒ«ã¨ãƒãƒŠãƒ¼_02.ï½–ãªãã¦ã‚‚ã„ã„ã€ã„ã‘ãªã„.md\":\"af00106f\",\"source_vue3_02-reactivity çš„æ ¸å¿ƒæµç¨‹.md\":\"a9560c8f\",\"japanese_ãƒ«ãƒ¼ãƒ«ã¨ãƒãƒŠãƒ¼_03.ã«ã™ã‚‹ã€ã©ã†ã—ã¦ã€ã§ã—ã‚‡ã†.md\":\"e89f87d3\",\"source_vue3_03-runtime-core åˆå§‹åŒ–çš„æ ¸å¿ƒæµç¨‹.md\":\"0b9611a9\",\"source_vue3_01-vue3 æºç ç»“æ„çš„ä»‹ç».md\":\"aeef7bce\",\"source_vue3_04-runtime-core æ›´æ–°çš„æ ¸å¿ƒæµç¨‹.md\":\"425997ba\",\"japanese_ãƒ«ãƒ¼ãƒ«ã¨ãƒãƒŠãƒ¼_04.nã«ã¤ã„ã¦ã€ã«ã€ã‹ã‚‰ã ....md\":\"9d8c56bb\",\"source_vue3_05-setup ç¯å¢ƒï¼šé›†æˆ jest _ ts.md\":\"7a05adc9\",\"interview_javascript_promiseé‡Œçš„ä»£ç ä¸ºä»€ä¹ˆæ¯”settimeoutå…ˆæ‰§è¡Œï¼Ÿ.md\":\"97e296cf\",\"source_vue3_06-å®ç° effect _ reactive ä¾èµ–æ”¶é›†_è§¦å‘ä¾èµ–.md\":\"f6e785fd\",\"source_vue3_08-å®ç° effect çš„scheduler åŠŸèƒ½.md\":\"56b0ee4e\",\"source_vue3_10-å®ç° readonly åŠŸèƒ½.md\":\"a2a0ed0d\",\"source_vue3_18-å®ç° proxyrefs åŠŸèƒ½.md\":\"999bdccd\",\"source_vue3_21-ä½¿ç”¨ rollup æ‰“åŒ…åº“.md\":\"9f10885a\",\"source_vue3_17-å®ç° isref å’Œ unref åŠŸèƒ½.md\":\"f148b757\",\"source_vue3_19-å®ç° computed è®¡ç®—å±æ€§.md\":\"b6ed9c65\",\"source_vue3_13-å®ç° reactive å’Œ readonly åµŒå¥—å¯¹è±¡è½¬æ¢åŠŸèƒ½.md\":\"6a4f3824\",\"source_vue3_14-å®ç° shallowreadonly åŠŸèƒ½.md\":\"cfd77c14\",\"source_vue3_15-å®ç° isproxy åŠŸèƒ½.md\":\"d22ff511\",\"algorithm_stack_å…³äºæ ˆ.md\":\"bc5f2b9f\",\"source_vue3_11-å®ç° isreactive å’Œ isreadonly.md\":\"e599a5d0\",\"source_vue3_07-å®ç° effect è¿”å› runner.md\":\"be520d83\",\"source_vue3_09-å®ç° effect çš„ stop åŠŸèƒ½.md\":\"2a52b796\",\"algorithm_chaintable_é“¾è¡¨å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆä¸€ï¼‰.md\":\"d159d860\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ç®€ä»‹_ä½œç”¨åŸŸ_.md\":\"601409eb\",\"interview_javascript_javascriptå¯è§†åŒ–ï¼špromiseå’Œasync.md\":\"8ffa39a7\",\"source_vue3_16-å®ç° ref åŠŸèƒ½.md\":\"d35539b8\",\"algorithm_chaintable_å•å‘é“¾è¡¨.md\":\"2208d3a7\",\"source_vue3_42-ç¼–è¯‘æ¨¡å—æ¦‚è¿°.md\":\"3c5d79a7\",\"source_vue3_20-å®ç°åˆå§‹åŒ– component ä¸»æµç¨‹.md\":\"c3040832\",\"japanese_ãŠã‚“ã›ã„_06.æ€»å¤ä¹ _æ—¥è¯­æ­Œæ›²å­¦ä¹ .md\":\"0c3d4bfe\",\"interview_javascript_inÂ è¿ç®—ç¬¦å’ŒÂ object.hasownpropertyÂ æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ.md\":\"4d31866b\",\"source_vue3_22-å®ç°åˆå§‹åŒ– element ä¸»æµç¨‹.md\":\"0c1090f3\",\"algorithm_stack_é€’å½’ä¸æ ˆå…¸å‹åº”ç”¨åœºæ™¯ï¼ˆå››ï¼‰.md\":\"55219d81\",\"interview_javascript_javascriptè®¾è®¡æ¨¡å¼ä¹‹å¤–è§‚æ¨¡å¼.md\":\"50b88d60\",\"interview_element_element-uiæºç è§£æä¹‹buttonç»„ä»¶.md\":\"cae0ae26\",\"algorithm_queue_å…³äºé˜Ÿåˆ—.md\":\"9faab359\",\"source_vue3_12-ä¼˜åŒ– stop åŠŸèƒ½.md\":\"9bc721cd\",\"interview_css3_å¦‚ä½•å®ç°ä¸€ä¸ªå…ƒç´ çš„æ°´å¹³å‚ç›´å±…ä¸­.md\":\"aaa903a2\",\"interview_vue-router_vrouter01.md\":\"f8dcbd78\",\"interview_javascript_javascriptè®¾è®¡æ¨¡å¼ä¹‹è£…é¥°è€…æ¨¡å¼.md\":\"0f469430\",\"source_vue3_24-å®ç° shapeflags.md\":\"a565bd21\",\"japanese_index.md\":\"f989150b\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡.md\":\"4b6afe8d\",\"source_vue3_28-å®ç°ç»„ä»¶ slots åŠŸèƒ½.md\":\"e353d381\",\"japanese_ã‚ã‚“ãªã„_01.ã†ãˆã€ã—ãŸã€ã¿ãã€ã²ã ã‚Š...md\":\"16d2c3de\",\"source_vue3_29-å®ç° fragment å’Œ text ç±»å‹èŠ‚ç‚¹.md\":\"37488c65\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ã€é—­åŒ…äºŒã€‘.md\":\"975ac627\",\"source_vue3_30-å®ç° getcurrentinstance.md\":\"21e1284b\",\"japanese_ãŠã‚“ã›ã„_02.ã•ãŸãªè¡Œï¼Œâ‘ â‘¡è°ƒ.md\":\"a55377ea\",\"blog_itwords.md\":\"18a14de3\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”prototypeåŸå‹.md\":\"061425e0\",\"source_vue3_31-å®ç°provide-inject åŠŸèƒ½.md\":\"f4c67d67\",\"japanese_ã‚ã‚“ãªã„_06.ã§ã‚ã‚‹ã€ã«ã€ã‹ã„ã‚.md\":\"ba346962\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”instanceof.md\":\"a9702e2d\",\"backend_server_å®‰è£…dockeråˆ°æœåŠ¡å™¨.md\":\"76aeadfc\",\"interview_javascript_ä»€ä¹ˆæ˜¯äº‹ä»¶ä¼ æ’­ï¼Ÿ.md\":\"8a36f939\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ã€é—­åŒ…ä¸€ã€‘.md\":\"914271b3\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ç»§æ‰¿.md\":\"65843068\",\"algorithm_queue_é˜Ÿåˆ—å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆä¸€ï¼‰.md\":\"73282dcc\",\"japanese_ãã‚‡ã†ã’ãã¨ã‹ã¶ã_01.ã²ã¨ã€ãŒã€ãŒã‚‹ã€ãŒã£ã¦ã„ã‚‹.md\":\"f6b0e1e6\",\"source_vue3_39-å­¦ä¹ å°¤å¤§è§£å†³bugçš„å¤„ç†æ–¹å¼.md\":\"1987d335\",\"source_vue3_34-æ›´æ–°element çš„ props.md\":\"79798032\",\"algorithm_binarytree_å…³äºäºŒå‰æ ‘.md\":\"98f5158b\",\"index.md\":\"66622526\",\"source_vue3_32-å®ç°è‡ªå®šä¹‰æ¸²æŸ“å™¨ custom renderer.md\":\"3c2e2f70\",\"backend_node_nodejsæ–‡ä»¶ç®¡ç†æ¨¡å—fsåŠæ¡ˆä¾‹.md\":\"c7f9c220\",\"interview_index.md\":\"d5974bd0\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”ç®€è¿°ã€æ‰§è¡Œä¸Šä¸‹æ–‡ã€‘ä¸‹.md\":\"d39ba441\",\"interview_javascript_javascriptè®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼.md\":\"dfb11e7e\",\"algorithm_queue_é˜Ÿåˆ—å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆä¸‰ï¼‰.md\":\"186d51f0\",\"backend_server_centoså®‰è£…nodejs.md\":\"c8b189cf\",\"source_vue3_41-å®ç° nexttick åŠŸèƒ½.md\":\"d71ff0eb\",\"algorithm_chaintable_é“¾è¡¨å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆå››ï¼‰.md\":\"2125dab9\",\"japanese_ãŒãã›ã„ã›ã„ã‹ã¤_02.ã£ã¦ã€ã¨ã€vã¦ã„ã‚‹ã€ã‹ã„ã‚.md\":\"9aff1693\",\"source_vue3_23-å®ç°ç»„ä»¶ä»£ç†å¯¹è±¡.md\":\"2a544f9b\",\"source_vue3_36-æ›´æ–° element çš„ children - åŒç«¯å¯¹æ¯”diff ç®—æ³• ï¼ˆ1ï¼‰.md\":\"955c8b29\",\"japanese_ãŒãã›ã„ã›ã„ã‹ã¤_04.ã¦ã„ã‚‹n1ã§n2ãŒã‚ã‚‹ã€ï½–ã¦.md\":\"4567653c\",\"source_vue3_35-æ›´æ–° element çš„ children.md\":\"b63770c0\",\"japanese_ã—ã‚“ã›ã„ã‹ã¤_01.n1ã¯n2ã§ã™.md\":\"a51648ff\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”_ä½œç”¨åŸŸ_å’Œ_ä¸Šä¸‹æ–‡ç¯å¢ƒ_.md\":\"71b587a0\",\"japanese_ã‚ã‚“ãªã„_04.ã§ã‚‚ã€ã¾ã›ã‚“ã‹ã€ã§ã—ã‚‡ã†.md\":\"60eac12f\",\"source_vue3_37-æ›´æ–° element çš„ children - åŒç«¯å¯¹æ¯”diff ç®—æ³• ï¼ˆ2ï¼‰.md\":\"b129a2c3\",\"algorithm_stack_é€’å½’ä¸æ ˆå…¸å‹åº”ç”¨åœºæ™¯ï¼ˆä¸‰ï¼‰.md\":\"1a8e0a90\",\"japanese_ãŠã‚“ã›ã„_01.æ—¥è¯­çš„æ„æˆï¼Œã‚ã‹è¡Œï¼Œâ“ªè°ƒ.md\":\"babca500\",\"algorithm_binarytree_äºŒå‰æ ‘ä¸ç»å…¸é—®é¢˜ï¼ˆå››ï¼‰.md\":\"04ecfdb5\",\"interview_vue_æ‰‹å†™vueæºç .md\":\"8443e649\",\"japanese_ã‚ã‚“ãªã„_03.ãŒã¿ãˆã‚‹ã€ã«ãªã‚‹...md\":\"3f43ea71\",\"japanese_ãã‚‡ã†ã’ãã¨ã‹ã¶ã_05.ï½ã¨ã¨ã‚‚ã«ã€ã“ã¨ã€ã«....md\":\"1921b722\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”this.md\":\"953682ce\",\"source_vue3_43-å®ç°è§£ææ’å€¼åŠŸèƒ½.md\":\"ff760b85\",\"interview_javascript_javascriptçš„newæ“ä½œéƒ½åšäº†ä»€ä¹ˆï¼Ÿ.md\":\"f439e1fe\",\"source_vue3_47-parse çš„å®ç°åŸç†.md\":\"cefcbea8\",\"japanese_ã‹ã„ã‚‚ã®_05.ã§ã”ã–ã„ã€ã„ãã‚‰ã€ã‚‚ã€ã ã‘...md\":\"0c2e3edd\",\"interview_javascript_call å’Œapply.md\":\"352695a4\",\"source_vue3_38-æ›´æ–° element çš„ children - åŒç«¯å¯¹æ¯”diff ç®—æ³• ï¼ˆ3ï¼‰.md\":\"292ce2f4\",\"japanese_ã¼ã†ã­ã‚“ã‹ã„_01.æ„å¿—å½¢ã€ã¨æ€ã†ã€äºˆå®šã ...md\":\"f048df45\",\"japanese_ã‚¹ãƒ”ãƒ¼ãƒã‚³ãƒ³ãƒ†ã‚¹ãƒˆå¿œæ´_01.ã«ã€ãã‚‹...md\":\"eacab9dc\",\"japanese_ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹.ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«_05.ã‚„ï½ãªã©.md\":\"4ede385a\",\"japanese_ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹.ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«_03.ã‹ã‚‰ã¾ã§ã€ã†ã³...md\":\"dee4f879\",\"interview_javascript_åŸç”Ÿjsçµé­‚ä¹‹é—®ï¼Œè¯·é—®ä½ èƒ½æ¥å¾—ä½å‡ ä¸ª(ä¸Š).md\":\"62985473\",\"japanese_ã¼ã†ã­ã‚“ã‹ã„_03.ã‚ã’ã‚‹ã€ãã‚Œã‚‹ã€ã‚‚ã‚‰ã†ã€ã‚‚..md\":\"0eb1c698\",\"source_vue3_25-å®ç°æ³¨å†Œäº‹ä»¶åŠŸèƒ½.md\":\"8f81e3cf\",\"source_vue3_26-å®ç°ç»„ä»¶ props åŠŸèƒ½.md\":\"dec713e1\",\"japanese_ãŒãã›ã„ã›ã„ã‹ã¤_05.ã‹ã„ã‚.md\":\"ef244ea6\",\"source_vue3_54-å®ç° watcheffect.md\":\"43ef336b\",\"source_vue3_27-å®ç°ç»„ä»¶ emit åŠŸèƒ½.md\":\"e4ec761b\",\"interview_javascript_æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…â€”æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ.md\":\"a20cd18b\",\"interview_javascript_javascriptè®¾è®¡æ¨¡å¼ä¹‹--æ„å»ºå‡½æ•°æ¨¡å¼.md\":\"ebe61596\",\"algorithm_binarytree_äºŒå‰æ ‘ä¸ç»å…¸é—®é¢˜ï¼ˆäºŒï¼‰.md\":\"2ba1bff6\",\"japanese_ã‚¹ãƒ”ãƒ¼ãƒã‚³ãƒ³ãƒ†ã‚¹ãƒˆå¿œæ´_04.ã‚ã®ã€ã‚’ã€ã¯ã—ã€ã‚ã‚‹.md\":\"10ae0478\",\"japanese_ã«ã»ã‚“ã”ã®ã¹ã‚“ãã‚‡ã†_03.ã‹ã£ãŸã€ã ã£ãŸã€ã©ã†ã§...md\":\"13f9cb5c\",\"japanese_ã‹ã„ã‚‚ã®_04.ã§ã€ã‹ã‚‰ãƒ»ã‹ã„ã‚.md\":\"003031d9\",\"source_vue3_40-å®ç°ç»„ä»¶æ›´æ–°åŠŸèƒ½.md\":\"9c22a112\",\"source_vue3_33-æ›´æ–°elementæµç¨‹æ­å»º.md\":\"bf634f41\",\"algorithm_queue_é˜Ÿåˆ—å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆäºŒï¼‰.md\":\"57b6e801\",\"japanese_ã‹ã„ã‚‚ã®_03.ã®ã€ã§ãƒ»ã‚“ï¼‘ã®ã‚“ï¼’.md\":\"940a8d93\",\"interview_javascript_javascriptè®¾è®¡æ¨¡å¼ä¹‹--å•ä¾‹æ¨¡å¼.md\":\"2c0b96ea\",\"interview_javascript_å¦‚ä½•å†™å‡ºä¸€ä¸ªæƒŠè‰³é¢è¯•å®˜çš„æ·±æ‹·è´ï¼Ÿ.md\":\"803370be\",\"interview_javascript_æ·±å…¥åˆ†æpromiseå®ç°ç»†èŠ‚.md\":\"4874a69d\"}")</script>
    <script type="module" async src="/assets/app.16764a97.js"></script>
    
  </body>
</html>